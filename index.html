<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no"/>
  <title>Hua Hin Properties | Luxury Asset Catalog</title>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@200;300;400;500;600&family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>

  <style>
    :root {
      --navy: #0B1829;
      --navy-dark: #060F1A;
      --gold: #C9A84C;
      --gold-lt: #E4C46A;
      --white: #FDFAF5;
      --muted: #7A9BB5;
      --border: rgba(255, 255, 255, 0.08);
      --card-bg: rgba(11, 24, 41, 0.9);
      --brand-red: #8B1F2D;
      --available: #2ECC8A;
      --reserved: #E8A020;
      --sold: #E05555;
      --rented: #5B9BD5;
      --row-h: 75px;
      --thumb-w: 110px;
      
      /* ‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì‡∏™‡πÄ‡∏Å‡∏•‡∏õ‡∏Å‡∏ï‡∏¥ */
      --line-scale: 1; 
    }

    /* ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô LINE */
    body.is-line {
      zoom: 0.92; /* ‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡∏•‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡πÄ‡∏ó‡πà‡∏≤ Chrome */
      -moz-transform: scale(0.92);
      -moz-transform-origin: 0 0;
    }
    body.is-line .prop-name { font-weight: 600; letter-spacing: 0.01em; }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background-color: var(--navy-dark);
      color: var(--white);
      font-family: 'Montserrat', 'Sarabun', sans-serif;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
    }

    body::before {
      content: '';
      position: fixed; inset: 0;
      background: radial-gradient(circle at 50% -10%, rgba(27, 79, 114, 0.3) 0%, transparent 70%);
      z-index: -1;
    }

    header {
      position: fixed; top: 0; width: 100%; height: 55px;
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 15px; background: rgba(6, 15, 26, 0.95);
      backdrop-filter: blur(15px); z-index: 1000;
      border-bottom: 1px solid var(--border);
    }
    .logo { font-size: 1.15rem; font-weight: 700; color: var(--gold); text-decoration: none; letter-spacing: 0.02em; }
    .logo span { color: var(--white); font-weight: 300; }
    .btn-contact {
      background: var(--gold); color: var(--navy-dark);
      padding: 6px 14px; border-radius: 4px; font-size: 0.65rem;
      font-weight: 800; text-decoration: none; text-transform: uppercase;
    }

    .hero { padding: 75px 15px 10px; text-align: center; }
    .hero-title-wrap {
      display: flex; align-items: center; justify-content: center;
      gap: 12px; margin-bottom: 12px;
    }
    .hero-title { font-size: 1.8rem; font-weight: 300; margin: 0; }
    .hero-title em { font-style: normal; color: var(--gold-lt); }
    
    /* ‡∏õ‡∏∏‡πà‡∏° Reset ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå Luxury */
    .btn-reset {
      background: rgba(255,255,255,0.05); border: 1px solid var(--border);
      color: var(--gold); width: 32px; height: 32px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; font-size: 1.1rem; transition: all 0.3s ease;
    }
    .btn-reset:active { transform: rotate(-180deg); color: var(--white); }

    .search-container { max-width: 550px; margin: 0 auto; }
    .search-box { position: relative; margin-bottom: 10px; }
    .search-input {
      width: 100%; background: rgba(255, 255, 255, 0.06);
      border: 1px solid var(--border); border-radius: 50px;
      padding: 10px 15px 10px 40px; color: var(--white);
      font-size: 0.85rem; font-family: 'Sarabun', sans-serif; outline: none;
    }
    .search-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--gold); font-size: 0.8rem; }

    .filters-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; margin-bottom: 10px; }
    .filter-select {
      background: rgba(255, 255, 255, 0.08); border: 1px solid var(--border);
      border-radius: 8px; padding: 8px; color: var(--white);
      font-size: 0.75rem; font-family: 'Sarabun', sans-serif; outline: none;
      appearance: none;
    }

    .pill-container { display: flex; gap: 6px; overflow-x: auto; padding-bottom: 8px; scrollbar-width: none; }
    .pill-container::-webkit-scrollbar { display: none; }
    .pill {
      white-space: nowrap; padding: 6px 14px; border-radius: 50px;
      background: rgba(255, 255, 255, 0.05); border: 1px solid var(--border);
      color: var(--muted); font-size: 0.65rem; font-weight: 700; cursor: pointer;
    }
    .pill.active { background: var(--gold); color: var(--navy-dark); border-color: var(--gold); }

    .section-bar {
      display: flex; justify-content: space-between; align-items: baseline;
      padding: 15px 15px 10px; border-top: 1px solid var(--border); margin-top: 10px;
    }
    .section-title { font-size: 1.15rem; font-weight: 300; }
    .unit-count { font-size: 0.65rem; color: var(--muted); font-weight: 700; letter-spacing: 1px; }

    .prop-list { padding: 0 12px 40px; display: grid; grid-template-columns: 1fr; gap: 6px; }

    .card {
      background: var(--card-bg); border: 1px solid var(--border);
      border-radius: 12px; display: flex; overflow: hidden;
      text-decoration: none; color: inherit; height: var(--row-h);
      transition: 0.2s ease;
    }
    .card:active { transform: scale(0.98); border-color: var(--gold); }

    .card-img { width: var(--thumb-w); flex-shrink: 0; position: relative; background: #000; }
    .card-img img { width: 100%; height: 100%; object-fit: cover; }
    
    /* ‡∏£‡∏´‡∏±‡∏™ HP-ID ‡∏ï‡∏±‡∏ß‡∏ö‡∏≤‡∏á/‡∏à‡∏≤‡∏á ‡∏ï‡∏≤‡∏°‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏î‡∏¥‡∏° */
    .hp-id {
      position: absolute; top: 5px; left: 7px; 
      font-size: 0.48rem; font-weight: 300; 
      color: rgba(255, 255, 255, 0.6); 
      text-shadow: 0 1px 2px rgba(0,0,0,0.8);
      z-index: 2;
    }

    .card-info { flex: 1; padding: 6px 10px; display: grid; grid-template-columns: 1fr auto; align-items: center; min-width: 0; }
    .info-main { min-width: 0; }
    .prop-name { font-size: 0.88rem; font-weight: 700; color: var(--white); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .prop-specs { font-size: 0.7rem; color: var(--muted); margin: 1px 0; }
    .prop-zone { font-size: 0.65rem; color: var(--muted); opacity: 0.6; }

    .price-side { display: flex; flex-direction: column; align-items: flex-end; gap: 2px; }
    .price { font-size: 1rem; font-weight: 800; color: var(--gold-lt); }
    
    .tag { font-size: 0.45rem; font-weight: 800; padding: 2px 6px; border-radius: 3px; text-transform: uppercase; letter-spacing: 0.5px; }
    .tag-status { background: rgba(255,255,255,0.08); color: var(--white); border: 0.5px solid rgba(255,255,255,0.15); }
    .tag-badge { background: var(--brand-red); color: white; }

    .skel { height: var(--row-h); background: rgba(255,255,255,0.03); border-radius: 12px; animation: pulse 1.5s infinite; }
    @keyframes pulse { 50% { opacity: 0.5; } }

    @media (min-width: 768px) {
      :root { --row-h: 90px; --thumb-w: 140px; }
      .prop-list { grid-template-columns: repeat(2, 1fr); gap: 12px; }
      .hero-title { font-size: 2.5rem; }
    }
  </style>
</head>
<body>

  <header>
    <a href="#" class="logo">HUA HIN<span>.PROPERTIES</span></a>
    <a href="https://line.me/R/ti/p/@qap7218t" class="btn-contact">Contact</a>
  </header>

  <section class="hero">
    <div class="hero-title-wrap">
      <h1 class="hero-title">Prime <em>Asset</em> Catalog</h1>
      <button class="btn-reset" onclick="resetFilters()" title="‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤">‚Üª</button>
    </div>
    
    <div class="search-container">
      <div class="search-box">
        <span class="search-icon">üîç</span>
        <input type="text" id="searchInput" class="search-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡πÄ‡∏•, ‡∏£‡∏´‡∏±‡∏™, ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£...">
      </div>

      <div class="filters-grid">
        <select id="areaFilter" class="filter-select">
          <option value="">‡∏ó‡∏∏‡∏Å‡πÇ‡∏ã‡∏ô</option>
          <option value="Hua Hin">‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô</option>
          <option value="Cha-am">‡∏ä‡∏∞‡∏≠‡∏≥</option>
          <option value="Pranburi">‡∏õ‡∏£‡∏≤‡∏ì‡∏ö‡∏∏‡∏£‡∏µ</option>
        </select>
        <select id="sortFilter" class="filter-select">
          <option value="">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤</option>
          <option value="low-high">‡∏ï‡πà‡∏≥ ‡πÑ‡∏õ ‡∏™‡∏π‡∏á</option>
          <option value="high-low">‡∏™‡∏π‡∏á ‡πÑ‡∏õ ‡∏ï‡πà‡∏≥</option>
        </select>
        <select id="bedFilter" class="filter-select">
          <option value="">‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3+</option>
        </select>
      </div>

      <div class="pill-container" id="pillBox">
        <div class="pill active" data-f="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
        <div class="pill" data-f="Sale">‡∏Ç‡∏≤‡∏¢</div>
        <div class="pill" data-f="Rent">‡πÄ‡∏ä‡πà‡∏≤</div>
        <div class="pill" data-f="Available">Available</div>
        <div class="pill" data-f="Pool Villa">Pool Villa</div>
        <div class="pill" data-f="Condo">Condo</div>
        <div class="pill" data-f="Land">‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô (Land)</div>
      </div>
    </div>
  </section>

  <div class="section-bar">
    <h2 class="section-title">Luxury Collections</h2>
    <span class="unit-count" id="unitCount">Loading...</span>
  </div>

  <section class="prop-list" id="propGrid">
    <div class="skel"></div><div class="skel"></div><div class="skel"></div><div class="skel"></div>
  </section>

  <script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec';
    let rawData = [];

    // ‚úÖ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡πÅ‡∏≠‡∏õ LINE ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏™‡πÄ‡∏Å‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    function checkLineBrowser() {
      const ua = navigator.userAgent || navigator.vendor || window.opera;
      if (ua.indexOf("Line") > -1) {
        document.body.classList.add('is-line');
        console.log("LINE Browser detected: Scaling applied.");
      }
    }

    async function getProperties() {
      try {
        const response = await fetch(SCRIPT_URL + '?mode=getUnitList');
        const json = await response.json();
        rawData = json.data.filter(item => item.System_Status === 'Live');
        renderList(rawData);
      } catch (err) { console.error(err); }
    }

    function getNumPrice(p) {
      const priceVal = p.Listing_Type === 'Sale' ? p.Sale_Price : p.Monthly_Rent;
      return parseFloat(String(priceVal || "0").replace(/[^0-9.]/g, '')) || 0;
    }

    function renderList(items) {
      const grid = document.getElementById('propGrid');
      document.getElementById('unitCount').textContent = `${items.length} UNITS`;
      if(items.length === 0) {
        grid.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--muted);">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';
        return;
      }
      grid.innerHTML = items.map(p => {
        const pNum = getNumPrice(p);
        const dPrice = pNum === 0 ? "‚Äî" : "‡∏ø" + pNum.toLocaleString();
        return `
          <a href="details.html?id=${p.HP_ID}" class="card">
            <div class="card-img">
              <span class="hp-id">#${p.HP_ID}</span>
              <img src="${p.Thumbnail_Image}" alt="prop" loading="lazy">
            </div>
            <div class="card-info">
              <div class="info-main">
                <div class="prop-name">${p.Listing_Type}: ${p.District}</div>
                <div class="prop-specs">${p.Bedrooms} Bed | ${p.Bathrooms} Bath | ${p.Living_Area_sq_m} sqm</div>
                <div class="prop-zone">Zone: ${p.Zone}</div>
              </div>
              <div class="price-side">
                <div class="price">${dPrice}</div>
                <div style="display:flex; flex-direction:column; gap:3px; align-items:flex-end;">
                  <span class="tag tag-status">${p.Status}</span>
                  ${p.Badge ? `<span class="tag tag-badge">${p.Badge}</span>` : ''}
                </div>
              </div>
            </div>
          </a>`;
      }).join('');
    }

    // ‚úÖ Instant Search Logic (‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏•‡πâ‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ)
    function filterData() {
      const q = document.getElementById('searchInput').value.trim().toLowerCase();
      const area = document.getElementById('areaFilter').value;
      const bed = document.getElementById('bedFilter').value;
      const sort = document.getElementById('sortFilter').value;
      const activePill = document.querySelector('.pill.active').dataset.f;

      let filtered = rawData.filter(p => {
        const text = `${p.District} ${p.HP_ID} ${p.Project_Name} ${p.Zone}`.toLowerCase();
        const matchQ = q === "" || text.includes(q);
        const matchArea = area === "" || p.District === area || p.Zone === area;
        const matchBed = bed === "" || (bed === "3" ? parseInt(p.Bedrooms) >= 3 : p.Bedrooms == bed);
        const matchPill = activePill === "all" || p.Listing_Type === activePill || p.Type === activePill || p.Status === activePill;
        return matchQ && matchArea && matchBed && matchPill;
      });

      if (sort === "low-high") filtered.sort((a, b) => getNumPrice(a) - getNumPrice(b));
      else if (sort === "high-low") filtered.sort((a, b) => getNumPrice(b) - getNumPrice(a));

      renderList(filtered);
    }

    function resetFilters() {
      document.getElementById('searchInput').value = "";
      document.getElementById('areaFilter').value = "";
      document.getElementById('sortFilter').value = "";
      document.getElementById('bedFilter').value = "";
      document.querySelectorAll('.pill').forEach(el => el.classList.remove('active'));
      document.querySelector('.pill[data-f="all"]').classList.add('active');
      renderList(rawData);
    }

    document.getElementById('searchInput').addEventListener('input', filterData);
    document.getElementById('areaFilter').addEventListener('change', filterData);
    document.getElementById('bedFilter').addEventListener('change', filterData);
    document.getElementById('sortFilter').addEventListener('change', filterData);
    document.getElementById('pillBox').addEventListener('click', (e) => {
      if (e.target.classList.contains('pill')) {
        document.querySelectorAll('.pill').forEach(el => el.classList.remove('active'));
        e.target.classList.add('active');
        filterData();
      }
    });

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
    checkLineBrowser();
    getProperties();
  </script>
</body>
</html>
