<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0"/>
  <title>Hua Hin Properties | Luxury Asset Catalog</title>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>

  <style>
    /* ═══════════════════════════════════════════
        TOKENS — Coastal Luxury (Red & Gold)
    ═══════════════════════════════════════════ */
    :root{
      --navy:#0B1829;
      --navy-mid:#112238;
      --navy-soft:#1a3350;
      --ocean:#1B4F72;
      --teal:#1A7A8A;
      --sand:#F5EDD8;
      --gold:#C9A84C;
      --gold-lt:#E4C46A;
      --white:#FDFAF5;
      --muted:#7A9BB5;
      --border:rgba(255,255,255,0.08);
      
      --brand-red:#8B1F2D;
      --brand-red2:#B12A3B;

      --available:#2ECC8A;
      --reserved:#E8A020;
      --sold:#E05555;
      --rented:#5B9BD5;

      --trans:0.25s cubic-bezier(.4,0,.2,1);
      --px:10px;
      --radius:8px;

      --row-h:70px;
      --thumb-w:100px;
    }

    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    html{scroll-behavior:smooth;-webkit-tap-highlight-color:transparent}
    body{
      background:var(--navy);
      color:var(--sand);
      /* เปลี่ยนฟอนต์หลักเป็น Montserrat และ Sarabun ทั้งหมดเพื่อให้ดูเรียบง่าย */
      font-family: 'Montserrat', 'Sarabun', sans-serif;
      font-weight:400;
      min-height:100dvh;
      overflow-x:hidden;
    }

    /* ═══ BACKGROUND ═══ */
    body::before{
      content:'';
      position:fixed;inset:0;
      background:radial-gradient(ellipse at 50% -10%, rgba(27,79,114,0.3) 0%, transparent 70%), #060F1A;
      z-index:0;
    }

    /* ═══ HEADER ═══ */
    header{
      position:fixed;top:0;left:0;right:0;z-index:300;
      height:50px;
      display:flex;align-items:center;justify-content:space-between;
      padding:0 var(--px);
      background:rgba(6,15,26,0.92);
      backdrop-filter:blur(15px);
      border-bottom:1px solid var(--border);
    }
    .logo{
      font-family:'Montserrat', sans-serif;
      font-size:1rem;color:var(--gold);text-decoration:none;letter-spacing:.02em;font-weight:700;
    }
    .logo span{color:var(--sand);font-weight:300}
    .btn-contact-header{
      padding:5px 10px;
      background:linear-gradient(135deg,var(--gold),var(--gold-lt));
      color:var(--navy);
      font-size:.58rem;font-weight:700;text-decoration:none;border-radius:3px;
    }

    /* ═══ HERO ═══ */
    .hero{position:relative;z-index:1;padding:65px var(--px) 5px;text-align:center}
    .hero-title{
      font-size:1.6rem;font-weight:700;color:var(--white);margin-bottom:5px;
      letter-spacing:-0.02em;
    }
    .hero-title em{
      font-style:normal;background:linear-gradient(135deg,var(--gold),var(--gold-lt));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    }

    /* ═══ SEARCH & FILTERS ═══ */
    .search-wrap{max-width:500px;margin:0 auto 8px;position:relative}
    .search-input{
      width:100%;padding:8px 12px;background:rgba(255,255,255,0.05);
      border:1px solid var(--border);border-radius:var(--radius);
      color:var(--white);font-size:.85rem;outline:none;font-family:'Sarabun', sans-serif;
    }
    .filters-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:5px;max-width:500px;margin:0 auto 10px}
    .filter-select{
      width:100%;padding:6px;background:rgba(255,255,255,0.06);
      border:1px solid var(--border);border-radius:6px;
      color:var(--sand);font-size:.75rem;outline:none;font-family:'Sarabun', sans-serif;
    }

    /* ═══ LISTINGS ═══ */
    .listings{padding:0 var(--px) 20px;position:relative;z-index:1}
    .listings-bar{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
    .listings-title{font-size:1rem;color:var(--white);font-weight:600}
    .listings-count{font-size:.55rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;font-weight:600}

    .grid{display:grid;grid-template-columns:1fr;gap:5px}

    /* ═══ CARD ═══ */
    .card{
      background:rgba(11,24,41,0.85);
      border:1px solid var(--border);
      border-radius:10px;
      display:flex;align-items:stretch;
      text-decoration:none;color:inherit;
      overflow:hidden;min-height:var(--row-h);
      transition:all var(--trans);
    }
    .card:active{transform:scale(0.98);border-color:var(--gold)}

    .c-img-box{
      width:var(--thumb-w);flex:0 0 var(--thumb-w);
      position:relative;background:#060F1A;
    }
    .c-img-box img{width:100%;height:100%;object-fit:cover;display:block}
    
    .id-on-img{
      position:absolute;top:4px;left:6px;
      font-size:.50rem;font-weight:700;
      color:rgba(255,255,255,0.9);
      text-shadow:0 1px 2px rgba(0,0,0,1);
      z-index:2;
    }

    .c-body{
      flex:1;padding:6px 10px;
      display:grid;grid-template-columns:1fr auto;
      align-items:center;min-width:0;
    }

    .info-side{min-width:0;display:flex;flex-direction:column;justify-content:center}
    .main-title{
      font-size:.85rem;color:var(--white);font-weight:600;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    }
    .sub-info{
      font-size:.65rem;color:var(--muted);margin-top:2px;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
      font-family:'Sarabun', sans-serif;
    }

    .status-side{
      display:flex;flex-direction:column;align-items:flex-end;
      justify-content:center;gap:3px;padding-left:8px;
    }
    .price-tag{
      font-size:0.95rem;font-weight:700;
      /* ปรับสีราคาให้เป็นสีทองสว่างเพื่อให้อ่านง่ายขึ้นบนพื้นหลังเข้ม */
      color: var(--gold-lt);
      letter-spacing: -0.01em;
    }

    .tag-container{display:flex;flex-wrap:wrap;justify-content:flex-end;gap:3px;max-width:80px}
    .mini-tag{
      font-size:.42rem;font-weight:700;
      padding:1px 5px;border-radius:3px;
      text-transform:uppercase;letter-spacing:0.5px;
    }
    .t-status{background:rgba(255,255,255,0.08);color:var(--sand);border:0.5px solid rgba(255,255,255,0.1)}
    .t-badge{background:var(--brand-red);color:white}

    /* ═══ SKELETON ═══ */
    .skel{height:var(--row-h);background:rgba(255,255,255,0.03);border-radius:10px;margin-bottom:5px;animation:pulse 1.5s infinite}
    @keyframes pulse{50%{opacity:.5}}

    /* ═══ RESPONSIVE ═══ */
    @media (min-width:768px){
      :root{--row-h:85px;--thumb-w:130px;}
      .grid{grid-template-columns:repeat(2,1fr);gap:10px}
      .main-title{font-size:1rem}
      .price-tag{font-size:1.1rem}
      .tag-container{max-width:120px}
    }
  </style>
</head>

<body>

  <header>
    <a href="#" class="logo">HUA HIN<span>.PROPERTIES</span></a>
    <a href="#" class="btn-contact-header">CONTACT</a>
  </header>

  <section class="hero">
    <h1 class="hero-title">PRIME <em>ASSET</em> CATALOG</h1>
    
    <div class="search-wrap">
      <input id="searchInput" class="search-input" type="text" placeholder="ค้นหาอสังหาฯ..."/>
    </div>

    <div class="filters-grid">
      <select id="selArea" class="filter-select"><option value="">ทุกโซน</option><option value="hua hin">หัวหิน</option><option value="cha-am">ชะอำ</option></select>
      <select id="selPrice" class="filter-select"><option value="">ทุกราคา</option><option value="0-10">ไม่เกิน 10M</option><option value="10-50">10M - 50M</option></select>
      <select id="selBeds" class="filter-select"><option value="">ห้องนอน</option><option value="1">1</option><option value="2">2</option><option value="3">3+</option></select>
    </div>
  </section>

  <section class="listings">
    <div class="listings-bar">
      <h2 class="listings-title">Luxury Collections</h2>
      <span class="listings-count" id="listCount">Loading...</span>
    </div>

    <div id="skelGrid">
      <div class="skel"></div><div class="skel"></div><div class="skel"></div><div class="skel"></div>
    </div>

    <div class="grid" id="propGrid"></div>
  </section>

  <script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec';
    let allProps = [];

    async function fetchData() {
      try {
        const r = await fetch(SCRIPT_URL + '?mode=getUnitList');
        const j = await r.json();
        allProps = j.data.filter(p => p['System_Status'] === 'Live');
        render(allProps);
      } catch (e) { console.error("Error fetching data"); }
    }

    function render(data) {
      document.getElementById('skelGrid').style.display = 'none';
      const grid = document.getElementById('propGrid');
      document.getElementById('listCount').textContent = `${data.length} UNITS`;

      grid.innerHTML = data.map(p => {
        const id = p['HP_ID'] || '0000';
        const title = p['Listing_Type'] === 'Rent' ? `For Rent: ${p['District']}` : `For Sale: ${p['District']}`;
        
        // ส่งค่าราคาไปจัดฟอร์แมตแบบเต็ม
        const price = formatPrice(p['Sale_Price'] || p['Monthly_Rent']);
        
        const thumb = p['Thumbnail_Image'] || 'https://via.placeholder.com/150x100?text=No+Image';
        const status = p['Status'] || 'Available';
        const badge = p['Badge'] || '';
        const specs = `${p['Bedrooms'] || 0} Bed | ${p['Bathrooms'] || 0} Bath | ${p['Living_Area_sq_m'] || 0} sqm`;

        return `
          <a class="card" href="details.html?id=${id}">
            <div class="c-img-box">
              <span class="id-on-img">#${id}</span>
              <img src="${thumb}" alt="property" loading="lazy">
            </div>
            <div class="c-body">
              <div class="info-side">
                <div class="main-title">${title}</div>
                <div class="sub-info">${specs}</div>
                <div class="sub-info" style="opacity:0.6">Zone: ${p['Zone'] || 'Hua Hin'}</div>
              </div>
              <div class="status-side">
                <div class="price-tag">${price}</div>
                <div class="tag-container">
                  <span class="mini-tag t-status">${status}</span>
                  ${badge ? `<span class="mini-tag t-badge">${badge}</span>` : ''}
                </div>
              </div>
            </div>
          </a>
        `;
      }).join('');
    }

    // ✅ แก้ไขฟังก์ชันการจัดรูปแบบราคาให้แสดงตัวเลขเต็ม
    function formatPrice(val) {
      if(!val || val === '#') return '—';
      // ดึงเฉพาะตัวเลขออกมา
      const n = parseFloat(String(val).replace(/[^\d.]/g, ''));
      if (isNaN(n)) return '—';
      
      // แสดงผลแบบใส่คอมม่า (เช่น 9,800,000)
      return '฿' + n.toLocaleString();
    }

    document.getElementById('searchInput').addEventListener('input', e => {
      const q = e.target.value.toLowerCase();
      const filtered = allProps.filter(p => 
        (p['District']||'').toLowerCase().includes(q) || 
        (p['HP_ID']||'').toLowerCase().includes(q) ||
        (p['Zone']||'').toLowerCase().includes(q)
      );
      render(filtered);
    });

    fetchData();
  </script>
</body>
</html>
