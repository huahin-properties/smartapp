<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"/>
  <title>Master Catalog | HUA HIN PROPERTIES</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root { --navy: #0B1829; --bg: #060F1A; --gold: #C9A84C; --white: #FFFFFF; --border: rgba(201, 168, 76, 0.2); --row-h: 85px; --thumb-w: 110px; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { background-color: var(--bg); color: var(--white); font-family: 'Montserrat', sans-serif; overflow-x: hidden; }
    header { position: fixed; top: 0; width: 100%; height: 60px; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; background: rgba(11, 24, 41, 0.98); backdrop-filter: blur(15px); z-index: 1000; border-bottom: 1px solid var(--border); }
    .hero { padding: 85px 15px 10px; text-align: center; }
    .search-input { width: 100%; max-width: 600px; background: rgba(255,255,255,0.05); border: 1.5px solid var(--gold); border-radius: 50px; padding: 12px 20px 12px 45px; color: var(--white); font-weight: 600; font-size: 0.9rem; outline: none; margin-bottom: 15px; }
    .pill-container { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 15px; scrollbar-width: none; justify-content: center; }
    .pill { white-space: nowrap; padding: 7px 16px; border-radius: 50px; background: rgba(255,255,255,0.03); border: 1px solid var(--border); color: #7A9BB5; font-size: 0.65rem; font-weight: 700; text-transform: uppercase; cursor: pointer; }
    .pill.active { background: var(--gold); color: var(--navy); border-color: var(--gold); }
    .prop-list { padding: 0 15px 40px; display: grid; grid-template-columns: 1fr; gap: 10px; }
    .card { background: rgba(255,255,255,0.02); border: 1px solid var(--border); border-radius: 14px; display: flex; height: var(--row-h); overflow: hidden; text-decoration: none; color: inherit; transition: 0.3s; }
    .card:hover { transform: translateY(-3px); border-color: var(--gold); background: rgba(255,255,255,0.05); }
    .card-img { width: var(--thumb-w); flex-shrink: 0; position: relative; background: #000; }
    .card-img img { width: 100%; height: 100%; object-fit: cover; }
    /* üéØ ‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏´‡∏±‡∏™ HP ‡πÅ‡∏ö‡∏ö‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÑ‡∏°‡πà‡∏°‡∏µ # */
    .hp-id { position: absolute; top: 5px; left: 5px; font-size: 0.5rem; color: var(--navy); background: var(--gold); padding: 2px 6px; border-radius: 4px; font-weight: 800; }
    .card-info { flex: 1; padding: 8px 12px; display: flex; flex-direction: column; justify-content: center; gap: 3px; min-width: 0; }
    .info-row { display: flex; justify-content: space-between; align-items: center; width: 100%; gap: 5px; }
    .prop-name { font-size: 0.85rem; font-weight: 700; color: var(--gold); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .price-new { font-size: 1rem; font-weight: 800; color: #FFF; white-space: nowrap; }
    .status-tag { font-size: 0.5rem; padding: 2px 6px; border-radius: 4px; border: 1px solid var(--gold); color: var(--gold); font-weight: 800; text-transform: uppercase; }
    .admin-float { position: fixed; bottom: 30px; right: 25px; width: 50px; height: 50px; background: var(--gold); border: none; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--navy); font-size: 20px; z-index: 9999; text-decoration: none; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
    @media (min-width: 768px) { :root { --row-h: 100px; --thumb-w: 150px; } .prop-list { grid-template-columns: 1fr 1fr; } }
  </style>
</head>
<body>
  <header><a href="#" style="color:var(--gold); font-weight:800; text-decoration:none; letter-spacing: -1px; font-size: 1.2rem; italic">MASTER CATALOG</a></header>
  <section class="hero">
    <div style="max-width:650px; margin:0 auto; position: relative;">
      <i class="fas fa-search" style="position: absolute; left: 20px; top: 15px; color: var(--gold); opacity: 0.5;"></i>
      <input type="text" id="sI" class="search-input" placeholder="Search Plot, Project or ID..." onkeyup="f()">
      <div class="pill-container" id="pillBox">
        <div class="pill active" data-f="all">All Assets</div>
        <div class="pill" data-f="Sale">Available</div>
        <div class="pill" data-f="Pool Villa">Pool Villa</div>
        <div class="pill" data-f="CoCo Hua Hin 88">CoCo</div>
        <div class="pill" data-f="The Pyne Plus">Pyne Plus</div>
      </div>
    </div>
  </section>
  <div style="display:flex; justify-content:space-between; padding:0 20px 10px; border-bottom:1px solid rgba(255,255,255,0.05);"><h2 style="font-size:0.75rem; color:var(--gold); text-transform:uppercase; font-weight:800; letter-spacing: 2px;">Inventory Stream</h2><span id="unitCount" style="font-size:0.65rem; color:#7A9BB5; font-weight:700;">Loading...</span></div>
  <main class="prop-list" id="propGrid"></main>
  <a href="dashboard.html" class="admin-float"><i class="fas fa-th-large"></i></a>
  <script>
    const API = "https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec";
    let data = [];
    async function init() {
      try {
        const res = await fetch(`${API}?mode=getListSmall&project=all`); // üéØ ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        data = await res.json(); f();
      } catch (err) { console.error(err); }
    }
    function f() {
      const q = document.getElementById('sI').value.toLowerCase();
      const pill = document.querySelector('.pill.active').dataset.f;
      // üéØ ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô Logic ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (‡πÄ‡∏≠‡∏≤‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç System_Status ‡∏≠‡∏≠‡∏Å)
      let res = data.filter(u => 
        (!q || `${u.HP_ID} ${u.Plot} ${u.Project_Name}`.toLowerCase().includes(q)) && 
        (pill === 'all' || u.Listing_Type === pill || u.Type === pill || (u.Project_Name && u.Project_Name.includes(pill)))
      );
      document.getElementById('unitCount').textContent = `${res.length} UNITS SYNCED`;
      document.getElementById('propGrid').innerHTML = res.map(u => `
          <a href="details.html?id=${u.HP_ID}" class="card">
            <div class="card-img">
              <span class="hp-id">${u.HP_ID}</span>
              <img src="${u.Thumbnail_Image || 'https://via.placeholder.com/400x250?text=NA'}" loading="lazy">
            </div>
            <div class="card-info">
              <div class="info-row"><div class="prop-name">Plot ${u.Plot || '-'}</div><div class="status-tag">${u.Status}</div></div>
              <div class="info-row"><div style="font-size:0.62rem; color:#7A9BB5; font-weight:600;">${u.Project_Name || 'Master'}</div><div class="price-new">‡∏ø${Number(u.Sale_Price || 0).toLocaleString()}</div></div>
              <div class="info-row"><div style="font-size:0.55rem; color:rgba(255,255,255,0.3); uppercase">${u.Bedrooms} Bed | ${u.Living_Area_sq_m || 0} m¬≤</div><i class="fas fa-chevron-right" style="font-size:8px; color:var(--gold)"></i></div>
            </div>
          </a>`).join('');
    }
    document.getElementById('pillBox').addEventListener('click', (e) => { if (e.target.classList.contains('pill')) { document.querySelectorAll('.pill').forEach(p => p.classList.remove('active')); e.target.classList.add('active'); f(); } });
    window.onload = init;
  </script>
</body>
</html>
