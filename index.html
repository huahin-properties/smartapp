<style>
  /* ... โค้ด CSS เดิมของคุณทั้งหมด ... */

  /* FOCUS MODE: สั่งซ่อนสิ่งที่รบกวนสายตา */
  body.mode-focus header,
  body.mode-focus .hero,
  body.mode-focus .search-container,
  body.mode-focus .section-bar .section-title {
    display: none !important;
  }
  body.mode-focus main {
    padding-top: 20px !important;
  }
  body.mode-focus .section-bar {
    border-top: none;
    justify-content: center;
  }
</style>

<script>
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec';
  const urlParams = new URLSearchParams(window.location.search);
  const isFocusMode = urlParams.get('mode') === 'focus';
  
  if (isFocusMode) document.body.classList.add('mode-focus');

  async function getProperties() {
    try {
      // ส่งค่า Filter ไปยัง Server โดยตรง
      const fetchUrl = `${SCRIPT_URL}?mode=getUnitList&${urlParams.toString()}`;
      const response = await fetch(fetchUrl);
      const json = await response.json();
      renderList(json.data);
    } catch (err) { console.error(err); }
  }

  function renderList(items) {
    const grid = document.getElementById('propGrid');
    document.getElementById('unitCount').textContent = `${items.length} UNITS FOUND FOR YOU`;
    
    grid.innerHTML = items.map(p => {
      // ตรวจสอบว่าต้องรักษาโหมด Focus ไปหน้าถัดไปไหม
      const detailLink = `details.html?id=${p.HP_ID}${isFocusMode ? '&mode=focus' : ''}`;
      
      const pNum = parseFloat(String(p.Sale_Price || "0").replace(/[^0-9.]/g, '')) || 0;
      const dPrice = pNum === 0 ? "—" : "฿" + pNum.toLocaleString();
      
      return `
        <a href="${detailLink}" class="card">
          <div class="card-img">
            <span class="hp-id">#${p.HP_ID}</span>
            <img src="${p.Thumbnail_Image}" alt="property" loading="lazy">
          </div>
          <div class="card-info">
            <div class="info-main">
              <div class="prop-name">${p.Project_Name || p.Listing_Type}</div>
              <div class="prop-specs">${p.Bedrooms} Bed | ${p.Bathrooms} Bath | ${p.Living_Area_sq_m} sqm</div>
              <div class="prop-zone">${p.Zone}</div>
            </div>
            <div class="price-side">
              <div class="price">${dPrice}</div>
              <span class="tag tag-status">${p.Status}</span>
            </div>
          </div>
        </a>`;
    }).join('');
  }
  
  getProperties();
</script>
