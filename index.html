<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
  <title>Hua Hin Properties | Luxury Asset Catalog</title>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>

  <style>
    :root {
      --navy: #0B1829;
      --navy-dark: #060F1A;
      --gold: #C9A84C;
      --gold-lt: #E4C46A;
      --white: #FDFAF5;
      --muted: #7A9BB5;
      --border: rgba(255, 255, 255, 0.08);
      --card-bg: rgba(11, 24, 41, 0.9);
      --brand-red: #8B1F2D;
      
      --available: #2ECC8A;
      --reserved: #E8A020;
      --sold: #E05555;
      --rented: #5B9BD5;

      /* Ratios based on 7.jpg */
      --row-h: 75px;
      --thumb-w: 110px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background-color: var(--navy-dark);
      color: var(--white);
      font-family: 'Montserrat', 'Sarabun', sans-serif;
      overflow-x: hidden;
    }

    /* BACKGROUND GRADIENT */
    body::before {
      content: '';
      position: fixed; inset: 0;
      background: radial-gradient(circle at 50% -10%, rgba(27, 79, 114, 0.3) 0%, transparent 70%);
      z-index: -1;
    }

    /* HEADER */
    header {
      position: fixed; top: 0; width: 100%; height: 55px;
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 15px; background: rgba(6, 15, 26, 0.95);
      backdrop-filter: blur(15px); z-index: 1000;
      border-bottom: 1px solid var(--border);
    }
    .logo { font-size: 1.15rem; font-weight: 700; color: var(--gold); text-decoration: none; letter-spacing: 0.02em; }
    .logo span { color: var(--white); font-weight: 300; }
    .btn-contact {
      background: var(--gold); color: var(--navy-dark);
      padding: 6px 14px; border-radius: 4px; font-size: 0.65rem;
      font-weight: 800; text-decoration: none; text-transform: uppercase;
    }

    /* SEARCH & HERO SECTION */
    .hero { padding: 75px 15px 10px; text-align: center; }
    .hero-title { font-size: 1.8rem; font-weight: 300; margin-bottom: 12px; }
    .hero-title em { font-style: normal; color: var(--gold-lt); }

    .search-container { max-width: 550px; margin: 0 auto; }
    .search-box { position: relative; margin-bottom: 10px; }
    .search-input {
      width: 100%; background: rgba(255, 255, 255, 0.06);
      border: 1px solid var(--border); border-radius: 50px;
      padding: 9px 15px 9px 40px; color: var(--white);
      font-size: 0.85rem; font-family: 'Sarabun', sans-serif;
    }
    .search-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--gold); font-size: 0.8rem; }

    .filters-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; margin-bottom: 10px; }
    .filter-select {
      background: rgba(255, 255, 255, 0.08); border: 1px solid var(--border);
      border-radius: 8px; padding: 8px; color: var(--white);
      font-size: 0.75rem; font-family: 'Sarabun', sans-serif; outline: none;
    }

    .pill-container { display: flex; gap: 6px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; }
    .pill-container::-webkit-scrollbar { display: none; }
    .pill {
      white-space: nowrap; padding: 6px 14px; border-radius: 50px;
      background: rgba(255, 255, 255, 0.05); border: 1px solid var(--border);
      color: var(--muted); font-size: 0.65rem; font-weight: 700; cursor: pointer;
    }
    .pill.active { background: var(--gold); color: var(--navy-dark); border-color: var(--gold); }

    /* LISTINGS BAR */
    .section-bar {
      display: flex; justify-content: space-between; align-items: baseline;
      padding: 15px 15px 10px; border-top: 1px solid var(--border); margin-top: 10px;
    }
    .section-title { font-size: 1.15rem; font-weight: 300; }
    .unit-count { font-size: 0.65rem; color: var(--muted); font-weight: 700; letter-spacing: 1px; }

    /* PROPERTY LIST GRID */
    .prop-list { padding: 0 12px 40px; display: grid; grid-template-columns: 1fr; gap: 6px; }

    /* LUXURY CARD DESIGN - MATCHING 7.JPG */
    .card {
      background: var(--card-bg); border: 1px solid var(--border);
      border-radius: 12px; display: flex; overflow: hidden;
      text-decoration: none; color: inherit; height: var(--row-h);
      transition: 0.2s ease;
    }
    .card:active { transform: scale(0.98); border-color: var(--gold); }

    .card-img { width: var(--thumb-w); flex-shrink: 0; position: relative; background: #000; }
    .card-img img { width: 100%; height: 100%; object-fit: cover; }
    
    .hp-id {
      position: absolute; top: 4px; left: 6px; font-size: 0.55rem;
      font-weight: 800; color: rgba(255,255,255,0.9);
      text-shadow: 0 1px 3px rgba(0,0,0,1);
    }

    .card-info { flex: 1; padding: 6px 10px; display: grid; grid-template-columns: 1fr auto; align-items: center; min-width: 0; }
    
    .info-main { min-width: 0; }
    .prop-name { font-size: 0.88rem; font-weight: 700; color: var(--white); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .prop-specs { font-size: 0.7rem; color: var(--muted); margin: 1px 0; }
    .prop-zone { font-size: 0.65rem; color: var(--muted); opacity: 0.6; }

    .price-side { display: flex; flex-direction: column; align-items: flex-end; gap: 2px; }
    .price { font-size: 1rem; font-weight: 800; color: var(--gold-lt); }
    
    .status-group { display: flex; flex-direction: column; gap: 3px; align-items: flex-end; }
    .tag { font-size: 0.45rem; font-weight: 800; padding: 2px 6px; border-radius: 3px; text-transform: uppercase; letter-spacing: 0.5px; }
    .tag-status { background: rgba(255,255,255,0.08); color: var(--white); border: 0.5px solid rgba(255,255,255,0.15); }
    .tag-badge { background: var(--brand-red); color: white; }

    /* SKELETON */
    .skel { height: var(--row-h); background: rgba(255,255,255,0.03); border-radius: 12px; animation: pulse 1.5s infinite; }
    @keyframes pulse { 50% { opacity: 0.5; } }

    @media (min-width: 768px) {
      :root { --row-h: 90px; --thumb-w: 140px; }
      .prop-list { grid-template-columns: repeat(2, 1fr); gap: 12px; }
      .hero-title { font-size: 2.5rem; }
    }
  </style>
</head>
<body>

  <header>
    <a href="#" class="logo">HUA HIN<span>.PROPERTIES</span></a>
    <a href="https://line.me/R/ti/p/@qap7218t" class="btn-contact">Contact</a>
  </header>

  <section class="hero">
    <h1 class="hero-title">Prime <em>Asset</em> Catalog</h1>
    
    <div class="search-container">
      <div class="search-box">
        <span class="search-icon">üîç</span>
        <input type="text" id="searchInput" class="search-input" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤... Pool Villa, Sea View, ‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô...">
      </div>

      <div class="filters-grid">
        <select id="areaFilter" class="filter-select">
          <option value="">‡∏ó‡∏∏‡∏Å‡πÇ‡∏ã‡∏ô</option>
          <option value="Hua Hin">‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô</option>
          <option value="Cha-am">‡∏ä‡∏∞‡∏≠‡∏≥</option>
          <option value="Pranburi">‡∏õ‡∏£‡∏≤‡∏ì‡∏ö‡∏∏‡∏£‡∏µ</option>
        </select>
        <select id="priceFilter" class="filter-select">
          <option value="">‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤</option>
          <option value="0-5000000">‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5M</option>
          <option value="5000000-15000000">5M - 15M</option>
          <option value="15000000-999999999">15M+</option>
        </select>
        <select id="bedFilter" class="filter-select">
          <option value="">‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3+</option>
        </select>
      </div>

      <div class="pill-container" id="pillBox">
        <div class="pill active" data-f="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
        <div class="pill" data-f="Sale">‡∏Ç‡∏≤‡∏¢</div>
        <div class="pill" data-f="Rent">‡πÄ‡∏ä‡πà‡∏≤</div>
        <div class="pill" data-f="Available">Available</div>
        <div class="pill" data-f="Pool Villa">Pool Villa</div>
        <div class="pill" data-f="Condo">Condo</div>
      </div>
    </div>
  </section>

  <div class="section-bar">
    <h2 class="section-title">Luxury Collections</h2>
    <span class="unit-count" id="unitCount">Loading...</span>
  </div>

  <section class="prop-list" id="propGrid">
    <div class="skel"></div><div class="skel"></div><div class="skel"></div><div class="skel"></div>
  </section>

  <script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec';
    let rawData = [];

    async function getProperties() {
      try {
        const response = await fetch(SCRIPT_URL + '?mode=getUnitList');
        const json = await response.json();
        rawData = json.data.filter(item => item.System_Status === 'Live');
        renderList(rawData);
      } catch (err) {
        console.error("Error fetching data:", err);
      }
    }

    function renderList(items) {
      const grid = document.getElementById('propGrid');
      const countLabel = document.getElementById('unitCount');
      countLabel.textContent = `${items.length} UNITS`;

      grid.innerHTML = items.map(p => {
        // Full price formatting with commas
        const priceVal = p.Listing_Type === 'Sale' ? p.Sale_Price : p.Monthly_Rent;
        const numPrice = parseFloat(priceVal.replace(/[^0-9.]/g, ''));
        const displayPrice = isNaN(numPrice) ? "‚Äî" : "‡∏ø" + numPrice.toLocaleString();
        
        const title = `${p.Listing_Type}: ${p.District}`;
        const specs = `${p.Bedrooms} Bed | ${p.Bathrooms} Bath | ${p.Living_Area_sq_m} sqm`;

        return `
          <a href="details.html?id=${p.HP_ID}" class="card">
            <div class="card-img">
              <span class="hp-id">#${p.HP_ID}</span>
              <img src="${p.Thumbnail_Image}" alt="property" loading="lazy">
            </div>
            <div class="card-info">
              <div class="info-main">
                <div class="prop-name">${title}</div>
                <div class="prop-specs">${specs}</div>
                <div class="prop-zone">Zone: ${p.Zone}</div>
              </div>
              <div class="price-side">
                <div class="price">${displayPrice}</div>
                <div class="status-group">
                  <span class="tag tag-status">${p.Status}</span>
                  ${p.Badge ? `<span class="tag tag-badge">${p.Badge}</span>` : ''}
                </div>
              </div>
            </div>
          </a>
        `;
      }).join('');
    }

    // SEARCH & FILTER LOGIC
    function filterData() {
      const q = document.getElementById('searchInput').value.toLowerCase();
      const area = document.getElementById('areaFilter').value;
      const bed = document.getElementById('bedFilter').value;
      const activePill = document.querySelector('.pill.active').dataset.f;

      const filtered = rawData.filter(p => {
        const matchQ = p.District.toLowerCase().includes(q) || p.HP_ID.toLowerCase().includes(q) || p.Project_Name.toLowerCase().includes(q);
        const matchArea = area === "" || p.District === area;
        const matchBed = bed === "" || (bed === "3" ? parseInt(p.Bedrooms) >= 3 : p.Bedrooms == bed);
        const matchPill = activePill === "all" || p.Listing_Type === activePill || p.Type === activePill || p.Status === activePill;
        
        return matchQ && matchArea && matchBed && matchPill;
      });

      renderList(filtered);
    }

    // EVENT LISTENERS
    document.getElementById('searchInput').addEventListener('input', filterData);
    document.getElementById('areaFilter').addEventListener('change', filterData);
    document.getElementById('bedFilter').addEventListener('change', filterData);
    
    document.getElementById('pillBox').addEventListener('click', (e) => {
      if (e.target.classList.contains('pill')) {
        document.querySelectorAll('.pill').forEach(el => el.classList.remove('active'));
        e.target.classList.add('active');
        filterData();
      }
    });

    getProperties();
  </script>
</body>
</html>
