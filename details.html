```html
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Hua Hin Properties Â· Details</title>
  <meta name="description" content="à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸­à¸ªà¸±à¸‡à¸«à¸²à¸£à¸´à¸¡à¸—à¸£à¸±à¸à¸¢à¹Œà¸£à¸°à¸”à¸±à¸š Luxury à¹ƒà¸™à¸«à¸±à¸§à¸«à¸´à¸™ à¸Šà¸°à¸­à¸³ à¸›à¸£à¸²à¸“à¸šà¸¸à¸£à¸µ â€” Pool Villa, Condo, Land" />
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400;1,600&family=Sarabun:wght@300;400;500;600&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet"/>

  <style>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TOKENS â€” Coastal Luxury (same as index)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    :root{
      --navy:#0B1829; --navy-mid:#112238; --navy-soft:#1a3350;
      --ocean:#1B4F72; --teal:#1A7A8A;
      --sand:#F5EDD8; --sand-dim:#C8B898;
      --gold:#C9A84C; --gold-lt:#E4C46A; --gold-glow:rgba(201,168,76,0.15);
      --white:#FDFAF5; --muted:#7A9BB5;
      --border:rgba(255,255,255,0.09);
      --card-bg:rgba(11,24,41,0.92);
      --available:#2ECC8A; --reserved:#E8A020; --sold:#E05555; --rented:#5B9BD5;
      --trans:0.32s cubic-bezier(0.4,0,0.2,1);
      --px:18px; --px-lg:52px;
      --radius:6px;
      --shadow:0 12px 30px rgba(0,0,0,.18);
    }

    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    html{scroll-behavior:smooth;-webkit-tap-highlight-color:transparent}
    body{
      background:var(--navy);
      color:var(--sand);
      font-family:'Sarabun',sans-serif;
      font-weight:300;
      min-height:100dvh;
      overflow-x:hidden;
    }

    /* â•â•â• OCEAN BACKGROUND â•â•â• */
    body::before{
      content:'';
      position:fixed;inset:0;
      background:
        radial-gradient(ellipse 80% 60% at 50% -10%, rgba(27,79,114,0.5) 0%, transparent 60%),
        radial-gradient(ellipse 60% 40% at 100% 80%, rgba(26,122,138,0.2) 0%, transparent 50%),
        radial-gradient(ellipse 50% 50% at 0% 100%, rgba(11,24,41,0.8) 0%, transparent 60%),
        linear-gradient(180deg, #060F1A 0%, #0B1829 40%, #0D1F35 100%);
      pointer-events:none; z-index:0;
    }
    body::after{
      content:'';
      position:fixed;
      bottom:0;left:-50%;
      width:200%;height:200px;
      background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 120'%3E%3Cpath fill='rgba(27,79,114,0.08)' d='M0,60 C360,120 1080,0 1440,60 L1440,120 L0,120 Z'/%3E%3C/svg%3E") repeat-x bottom;
      background-size:800px 120px;
      animation:wave 12s linear infinite;
      pointer-events:none;
      z-index:0;
      opacity:0.6;
    }
    @keyframes wave{from{transform:translateX(0)}to{transform:translateX(50%)}}

    /* â•â•â• HEADER â•â•â• */
    header{
      position:fixed;top:0;left:0;right:0;z-index:300;
      height:58px;
      display:flex;align-items:center;justify-content:space-between;
      padding:0 var(--px);
      background:rgba(6,15,26,0.88);
      backdrop-filter:blur(20px);
      -webkit-backdrop-filter:blur(20px);
      border-bottom:1px solid var(--border);
    }
    .logo{
      font-family:'Cormorant Garamond',serif;
      font-size:1.05rem;font-weight:400;
      letter-spacing:0.1em;text-transform:uppercase;
      color:var(--gold);text-decoration:none;line-height:1;
      display:flex;align-items:center;gap:10px;
    }
    .logo span{color:var(--sand);font-style:italic;font-weight:300}
    .nav-right{display:flex;align-items:center;gap:10px}
    .btn{
      border:1px solid rgba(201,168,76,0.35);
      color:var(--gold);
      font-family:'Montserrat',sans-serif;
      font-size:0.58rem;font-weight:600;
      letter-spacing:0.16em;text-transform:uppercase;
      padding:8px 12px;border-radius:2px;
      background:transparent;
      transition:all var(--trans);
      text-decoration:none;display:inline-flex;align-items:center;gap:8px;
      white-space:nowrap;
    }
    .btn:hover{background:var(--gold);color:var(--navy);border-color:var(--gold);transform:translateY(-1px)}
    .btn-solid{
      background:linear-gradient(135deg,var(--gold),var(--gold-lt));
      color:var(--navy);
      border-color:transparent;
    }
    .btn-solid:hover{opacity:.9}

    /* â•â•â• PAGE WRAP â•â•â• */
    .wrap{
      position:relative;z-index:1;
      padding:86px var(--px) 90px;
      max-width:1160px;margin:0 auto;
    }

    /* â•â•â• TOP TITLE â•â•â• */
    .crumb{
      display:flex;align-items:center;gap:10px;
      color:var(--muted);
      font-family:'Montserrat',sans-serif;
      font-size:0.55rem;letter-spacing:0.22em;text-transform:uppercase;
      margin-bottom:14px;
      opacity:0;animation:fadeUp .7s .08s ease forwards;
    }
    .crumb a{color:var(--teal);text-decoration:none}
    .crumb a:hover{color:var(--gold)}
    .h1{
      font-family:'Cormorant Garamond',serif;
      font-size:clamp(2.0rem,6.5vw,3.2rem);
      font-weight:300;line-height:1.12;
      color:var(--white);
      margin-bottom:10px;
      opacity:0;animation:fadeUp .7s .18s ease forwards;
    }
    .sub{
      color:var(--muted);
      font-size:0.92rem;line-height:1.7;
      max-width:780px;
      opacity:0;animation:fadeUp .7s .28s ease forwards;
    }

    /* â•â•â• LAYOUT GRID â•â•â• */
    .grid{
      margin-top:22px;
      display:grid;
      grid-template-columns:1fr;
      gap:14px;
    }
    @media(min-width:980px){
      .grid{grid-template-columns:1.35fr .9fr; gap:18px;}
    }

    /* â•â•â• CARD â•â•â• */
    .card{
      background:var(--card-bg);
      border:1px solid var(--border);
      border-radius:var(--radius);
      overflow:hidden;
      box-shadow:var(--shadow);
      backdrop-filter:blur(12px);
    }
    .card-h{
      padding:14px 16px 12px;
      border-bottom:1px solid var(--border);
      display:flex;align-items:flex-start;justify-content:space-between;gap:12px;
    }
    .tag-zone{
      font-family:'Montserrat',sans-serif;
      font-size:0.55rem;letter-spacing:0.22em;text-transform:uppercase;
      color:var(--teal);
      margin-bottom:6px;
    }
    .name{
      font-family:'Cormorant Garamond',serif;
      font-size:1.35rem;font-weight:400;line-height:1.2;
      color:var(--white);
    }
    .mini{
      margin-top:6px;
      font-size:0.82rem;color:var(--muted);line-height:1.5;
    }

    /* Status + Badge */
    .chips{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
    .chip{
      display:inline-flex;align-items:center;gap:6px;
      padding:5px 10px;
      background:rgba(6,15,26,0.75);
      border:1px solid rgba(255,255,255,0.10);
      border-radius:999px;
      font-family:'Montserrat',sans-serif;
      font-size:0.52rem;letter-spacing:0.12em;text-transform:uppercase;
      color:var(--sand);
      white-space:nowrap;
    }
    .dot{width:6px;height:6px;border-radius:50%}
    .d-av{background:var(--available);box-shadow:0 0 6px var(--available)}
    .d-rs{background:var(--reserved);box-shadow:0 0 6px var(--reserved)}
    .d-sd{background:var(--sold);box-shadow:0 0 6px var(--sold)}
    .d-rt{background:var(--rented);box-shadow:0 0 6px var(--rented)}
    .chip-badge{
      background:linear-gradient(135deg,var(--gold),var(--gold-lt));
      color:var(--navy);
      border-color:transparent;
      font-weight:700;
    }

    /* â•â•â• ALBUM â•â•â• */
    .album{
      position:relative;
      background:#060F1A;
    }
    .viewer{
      position:relative;
      width:100%;
      aspect-ratio:16/9;
      overflow:hidden;
      background:#060F1A;
    }
    .viewer img{
      width:100%;height:100%;
      object-fit:cover;display:block;
      filter:brightness(0.9) saturate(1.08);
      transform:scale(1.001);
    }
    .shade{
      position:absolute;inset:0;
      background:linear-gradient(to bottom, transparent 45%, rgba(11,24,41,0.55) 72%, rgba(11,24,41,0.95) 100%);
      pointer-events:none;
    }
    .nav{
      position:absolute;inset:0;
      display:flex;align-items:center;justify-content:space-between;
      padding:0 10px;
      pointer-events:none;
    }
    .nav button{
      pointer-events:auto;
      width:42px;height:42px;border-radius:999px;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(6,15,26,0.55);
      color:var(--sand);
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;
      backdrop-filter:blur(8px);
      transition:all var(--trans);
    }
    .nav button:hover{border-color:rgba(201,168,76,0.55);transform:translateY(-1px)}
    .nav button:active{transform:translateY(0)}
    .nav svg{opacity:.9}

    .topline{
      position:absolute;left:12px;right:12px;bottom:12px;
      display:flex;align-items:flex-end;justify-content:space-between;gap:12px;
    }
    .pricebox{
      background:rgba(6,15,26,0.55);
      border:1px solid rgba(255,255,255,0.12);
      border-radius:var(--radius);
      padding:10px 12px;
      backdrop-filter:blur(10px);
      min-width:180px;
    }
    .plbl{
      font-family:'Montserrat',sans-serif;
      font-size:0.52rem;letter-spacing:0.18em;text-transform:uppercase;
      color:rgba(122,155,181,0.85);
      margin-bottom:4px;
    }
    .pval{
      font-family:'Cormorant Garamond',serif;
      font-size:1.7rem;font-weight:400;line-height:1;
      background:linear-gradient(135deg,var(--gold),var(--gold-lt));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
      background-clip:text;
    }
    .count{
      font-family:'Montserrat',sans-serif;
      font-size:0.56rem;letter-spacing:0.18em;text-transform:uppercase;
      color:rgba(245,237,216,0.65);
      background:rgba(6,15,26,0.45);
      border:1px solid rgba(255,255,255,0.10);
      padding:8px 10px;border-radius:999px;
      backdrop-filter:blur(10px);
      white-space:nowrap;
    }

    .thumbs{
      display:flex;gap:8px;
      overflow-x:auto;
      padding:10px 12px 12px;
      background:rgba(6,15,26,0.55);
      border-top:1px solid rgba(255,255,255,0.08);
      scrollbar-width:none;
    }
    .thumbs::-webkit-scrollbar{display:none}
    .t{
      width:86px;height:54px;
      flex:0 0 auto;
      border-radius:4px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,0.12);
      cursor:pointer;
      position:relative;
      background:#091425;
      transition:transform var(--trans), border-color var(--trans), opacity var(--trans);
      opacity:.85;
    }
    .t:hover{border-color:rgba(201,168,76,0.55);opacity:1}
    .t.active{border-color:rgba(201,168,76,0.95);opacity:1;transform:translateY(-1px)}
    .t img{width:100%;height:100%;object-fit:cover;display:block;filter:brightness(.92) saturate(1.05)}

    /* â•â•â• CONTENT SECTIONS â•â•â• */
    .card-b{padding:14px 16px 16px}
    .section{padding:14px 0;border-top:1px solid var(--border)}
    .section:first-child{border-top:none;padding-top:0}
    .stitle{
      font-family:'Montserrat',sans-serif;
      font-size:0.55rem;letter-spacing:0.28em;text-transform:uppercase;
      color:var(--gold);
      margin-bottom:10px;
    }
    .desc{
      color:rgba(245,237,216,0.9);
      font-size:0.95rem;line-height:1.85;
      white-space:pre-line;
    }

    .specgrid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:10px;
    }
    @media(min-width:520px){
      .specgrid{grid-template-columns:repeat(3,1fr)}
    }
    .spec{
      background:rgba(255,255,255,0.04);
      border:1px solid rgba(255,255,255,0.10);
      border-radius:var(--radius);
      padding:10px 10px;
      display:flex;flex-direction:column;gap:4px;
      min-height:64px;
    }
    .sk{
      font-family:'Montserrat',sans-serif;
      font-size:0.52rem;letter-spacing:0.16em;text-transform:uppercase;
      color:rgba(122,155,181,0.9);
    }
    .sv{
      color:var(--white);
      font-size:0.95rem;
    }

    /* â•â•â• SIDE PANEL â•â•â• */
    .side{display:flex;flex-direction:column;gap:14px}
    .quick{
      padding:14px 16px 16px;
    }
    .qrow{display:flex;gap:10px;flex-wrap:wrap}
    .btn-wide{flex:1 1 160px;justify-content:center}
    .hint{
      margin-top:10px;
      font-size:0.82rem;line-height:1.6;
      color:var(--muted);
    }

    .map{
      padding:14px 16px 16px;
    }
    .mapbox{
      border-radius:var(--radius);
      overflow:hidden;
      border:1px solid rgba(255,255,255,0.10);
      background:#060F1A;
      height:260px;
    }
    .mapbox iframe{width:100%;height:100%;border:0;display:block}
    .map-links{margin-top:10px;display:flex;gap:10px;flex-wrap:wrap}

    /* â•â•â• LOADING / ERROR â•â•â• */
    .skeleton{
      background:linear-gradient(90deg,#112238 25%,#1a3350 50%,#112238 75%);
      background-size:200% 100%;
      animation:shimmer 1.4s infinite;
      border-radius:var(--radius);
    }
    .sk-img{aspect-ratio:16/9}
    .sk-ln{height:12px;margin:10px 0}
    .sk-ln.s{width:35%} .sk-ln.m{width:60%} .sk-ln.l{width:85%}
    @keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
    @keyframes fadeUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}

    .err{
      display:none;
      padding:12px 14px;
      border-radius:var(--radius);
      background:rgba(224,85,85,.10);
      border:1px solid rgba(224,85,85,.30);
      color:#ef9090;
      font-size:.9rem;
      margin-top:16px;
    }

    /* â•â•â• LIGHTBOX â•â•â• */
    .lb{
      position:fixed;inset:0;z-index:999;
      background:rgba(0,0,0,0.72);
      display:none;
      align-items:center;justify-content:center;
      padding:18px;
    }
    .lb.on{display:flex}
    .lb-inner{
      width:min(1100px,100%);
      border-radius:12px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,0.12);
      background:#050B12;
      box-shadow:0 26px 80px rgba(0,0,0,.55);
      position:relative;
    }
    .lb-top{
      display:flex;align-items:center;justify-content:space-between;
      padding:10px 12px;
      border-bottom:1px solid rgba(255,255,255,0.10);
      background:rgba(6,15,26,0.7);
      color:var(--sand);
    }
    .lb-title{
      font-family:'Montserrat',sans-serif;
      font-size:0.56rem;letter-spacing:0.22em;text-transform:uppercase;
      color:rgba(245,237,216,0.75);
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
      max-width:75%;
    }
    .lb-close{
      width:38px;height:38px;border-radius:999px;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(6,15,26,0.55);
      color:var(--sand);
      cursor:pointer;
      transition:all var(--trans);
    }
    .lb-close:hover{border-color:rgba(201,168,76,0.55);transform:translateY(-1px)}
    .lb-img{
      width:100%;
      max-height:78vh;
      object-fit:contain;
      display:block;
      background:#050B12;
    }
  </style>
</head>

<body>
  <!-- HEADER -->
  <header>
    <a href="index.html" class="logo">Hua Hin<span>.Properties</span></a>
    <div class="nav-right">
      <a id="btnBack" class="btn" href="index.html">â† Back</a>
      <a id="btnContactTop" class="btn btn-solid" href="#contact">Contact</a>
    </div>
  </header>

  <main class="wrap">
    <div class="crumb">
      <a href="index.html">Listings</a>
      <span>â€º</span>
      <span id="crumbId">â€”</span>
    </div>

    <h1 class="h1" id="title">Loadingâ€¦</h1>
    <p class="sub" id="subtitle">à¸à¸³à¸¥à¸±à¸‡à¹‚à¸«à¸¥à¸”à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”â€¦</p>

    <div class="err" id="errBox"></div>

    <section class="grid" id="mainGrid">
      <!-- LEFT: album + details -->
      <div class="card" id="leftCard">
        <div class="album">
          <div class="viewer" id="viewer">
            <div class="skeleton sk-img" id="skImg"></div>
            <img id="mainImg" alt="" style="display:none" />
            <div class="shade"></div>

            <div class="nav">
              <button id="prevBtn" aria-label="Previous image" title="Previous">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <button id="nextBtn" aria-label="Next image" title="Next">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>

            <div class="topline">
              <div class="pricebox">
                <div class="plbl" id="priceLbl">Price</div>
                <div class="pval" id="priceVal">â€”</div>
              </div>
              <div class="count" id="imgCount">0 Photos</div>
            </div>
          </div>

          <div class="thumbs" id="thumbs"></div>
        </div>

        <div class="card-h">
          <div>
            <div class="tag-zone" id="zone">â€”</div>
            <div class="name" id="name">â€”</div>
            <div class="mini" id="mini">â€”</div>
          </div>
          <div class="chips" id="chips"></div>
        </div>

        <div class="card-b">
          <div class="section">
            <div class="stitle">Key Specs</div>
            <div class="specgrid" id="specGrid">
              <div class="spec"><div class="sk">Bedrooms</div><div class="sv" id="vBeds">â€”</div></div>
              <div class="spec"><div class="sk">Bathrooms</div><div class="sv" id="vBaths">â€”</div></div>
              <div class="spec"><div class="sk">Living Area</div><div class="sv" id="vLiving">â€”</div></div>
              <div class="spec"><div class="sk">Land</div><div class="sv" id="vLand">â€”</div></div>
              <div class="spec"><div class="sk">Pool</div><div class="sv" id="vPool">â€”</div></div>
              <div class="spec"><div class="sk">Ownership</div><div class="sv" id="vOwn">â€”</div></div>
            </div>
          </div>

          <div class="section">
            <div class="stitle">Description</div>
            <div class="desc" id="desc">â€”</div>
          </div>

          <div class="section" id="extrasSec" style="display:none">
            <div class="stitle">Extras</div>
            <div class="desc" id="extras">â€”</div>
          </div>

          <div class="section" id="linksSec" style="display:none">
            <div class="stitle">Links</div>
            <div class="qrow" id="linksRow"></div>
          </div>

          <div class="section" id="pdfSec" style="display:none">
            <div class="stitle">PDF</div>
            <div class="qrow" id="pdfRow"></div>
          </div>
        </div>
      </div>

      <!-- RIGHT: quick actions + map -->
      <aside class="side">
        <div class="card quick" id="contact">
          <div class="stitle">Contact</div>
          <div class="qrow">
            <a class="btn btn-solid btn-wide" id="btnLine" href="#" target="_blank" rel="noopener">LINE OA</a>
            <a class="btn btn-wide" id="btnWa" href="#" target="_blank" rel="noopener">WhatsApp</a>
            <a class="btn btn-wide" id="btnFb" href="#" target="_blank" rel="noopener">Facebook</a>
            <a class="btn btn-wide" id="btnCall" href="#" >Call</a>
          </div>
          <div class="hint" id="hint">
            à¸à¸”à¸›à¸¸à¹ˆà¸¡à¸”à¹‰à¸²à¸™à¸šà¸™à¹€à¸à¸·à¹ˆà¸­à¸ªà¸­à¸šà¸–à¸²à¸¡à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸” / à¸™à¸±à¸”à¸Šà¸¡à¸šà¹‰à¸²à¸™<br/>
            (à¸¥à¸´à¸‡à¸à¹Œà¸ˆà¸°à¹€à¸›à¸´à¸”à¹à¸—à¹‡à¸šà¹ƒà¸«à¸¡à¹ˆ)
          </div>
        </div>

        <div class="card map" id="mapCard" style="display:none">
          <div class="stitle">Map</div>
          <div class="mapbox" id="mapBox"></div>
          <div class="map-links">
            <a class="btn btn-wide" id="btnMap" href="#" target="_blank" rel="noopener">Open Google Maps</a>
            <a class="btn btn-wide" id="btnTour" href="#" target="_blank" rel="noopener" style="display:none">Virtual Tour</a>
          </div>
        </div>

        <div class="card map" id="metaCard">
          <div class="stitle">Property ID</div>
          <div class="desc" id="pidBox">â€”</div>
          <div style="height:10px"></div>
          <div class="stitle">Project</div>
          <div class="desc" id="projBox">â€”</div>
        </div>
      </aside>
    </section>
  </main>

  <!-- LIGHTBOX -->
  <div class="lb" id="lb">
    <div class="lb-inner">
      <div class="lb-top">
        <div class="lb-title" id="lbTitle">Photo</div>
        <button class="lb-close" id="lbClose" aria-label="Close">âœ•</button>
      </div>
      <img class="lb-img" id="lbImg" alt=""/>
    </div>
  </div>

  <script>
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // CONFIG (same pattern as your index)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec';

    // Album Drive Folder ID (your new app)
    const ALBUM_FOLDER_ID = '1-DLZIYoGtDhRk5MKkWWZ05N_zv-XetJ4';

    // Contact defaults (edit if you want)
    const CONTACT = {
      line: 'https://line.me/R/ti/p/@qap7218t',
      wa:   'https://wa.me/66805820777?text=Interested',
      fb:   'https://m.me/huahinpropertyhuahinrealestate/',
      tel:  'tel:+66805820777'
    };

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // GET PARAMS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const qp = new URLSearchParams(location.search);
    const HP_ID = (qp.get('id') || '').trim();
    document.getElementById('crumbId').textContent = HP_ID || 'â€”';
    document.getElementById('pidBox').textContent  = HP_ID || 'â€”';

    // back link preserves possible filters (simple)
    const btnBack = document.getElementById('btnBack');
    if (document.referrer && document.referrer.includes('index.html')) btnBack.href = document.referrer;

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // HELPERS â€” image rules (important for "à¸£à¸¹à¸›à¹„à¸¡à¹ˆà¸‚à¸¶à¹‰à¸™")
    // - Accept:
    //   1) already a full url (http)
    //   2) a Google Drive fileId -> convert to lh3
    //   3) comma/newline separated list
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function isLikelyFileId(s){
      if (!s) return false;
      const x = String(s).trim();
      if (x.startsWith('http')) return false;
      // common Drive fileId length 20-80, letters digits - _
      return /^[a-zA-Z0-9_-]{20,120}$/.test(x);
    }
    function toLh3(s){
      const x = String(s||'').trim();
      if (!x) return '';
      if (x.startsWith('http')) return x;
      if (isLikelyFileId(x)) return 'https://lh3.googleusercontent.com/d/' + x;
      return x;
    }
    function splitList(s){
      const x = String(s||'').trim();
      if (!x) return [];
      // support CSV, newline, pipe
      return x.split(/[\n,|]+/).map(v=>v.trim()).filter(Boolean);
    }

    function fmtPrice(sale, rent, ltype){
      const src = (ltype === 'Rent') ? rent : (sale && sale !== '#' ? sale : rent);
      if (!src || src === '#') return 'â€”';
      const n = parseFloat(String(src).replace(/[^\d.]/g,''));
      if (!n) return 'â€”';
      const sfx = (ltype === 'Rent' || (!sale && rent)) ? '/mo' : '';
      if (n >= 1e6) return 'à¸¿' + (n/1e6).toFixed(1) + 'M' + sfx;
      if (n >= 1e3) return 'à¸¿' + Math.round(n/1e3) + 'K' + sfx;
      return 'à¸¿' + n.toLocaleString() + sfx;
    }
    function dotCls(st){
      return { Available:'d-av', Reserved:'d-rs', Sold:'d-sd', Rented:'d-rt' }[st] || 'd-av';
    }

    function showErr(msg){
      const e = document.getElementById('errBox');
      e.textContent = 'âš  ' + msg;
      e.style.display = 'block';
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ALBUM UI
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    let imgs = [];
    let idx  = 0;
    const mainImg = document.getElementById('mainImg');
    const skImg   = document.getElementById('skImg');
    const thumbs  = document.getElementById('thumbs');
    const imgCount= document.getElementById('imgCount');

    function setMain(i){
      if (!imgs.length) return;
      idx = (i + imgs.length) % imgs.length;

      // active thumb
      [...thumbs.querySelectorAll('.t')].forEach((el, k)=>el.classList.toggle('active', k===idx));

      const url = imgs[idx];
      skImg.style.display = 'block';
      mainImg.style.display = 'none';

      // preload then swap (prevents flash)
      const im = new Image();
      im.onload = () => {
        mainImg.src = url;
        mainImg.style.display = 'block';
        skImg.style.display = 'none';
      };
      im.onerror = () => {
        // if fail: still hide skeleton but show empty
        skImg.style.display = 'none';
        mainImg.style.display = 'none';
      };
      im.src = url;

      imgCount.textContent = `${idx+1} / ${imgs.length} Photos`;
    }

    function renderThumbs(){
      thumbs.innerHTML = imgs.map((u,i)=>`
        <div class="t ${i===0?'active':''}" data-i="${i}" title="Photo ${i+1}">
          <img src="${u}" alt="thumb ${i+1}" loading="lazy" onerror="this.style.display='none'">
        </div>
      `).join('');
      thumbs.addEventListener('click', (e)=>{
        const t = e.target.closest('.t');
        if(!t) return;
        setMain(parseInt(t.dataset.i,10));
      });
    }

    document.getElementById('prevBtn').addEventListener('click', ()=>setMain(idx-1));
    document.getElementById('nextBtn').addEventListener('click', ()=>setMain(idx+1));

    // swipe on viewer
    (function enableSwipe(){
      const viewer = document.getElementById('viewer');
      let sx=0, sy=0, active=false;
      viewer.addEventListener('touchstart', (e)=>{
        if(!imgs.length) return;
        const t=e.touches[0];
        sx=t.clientX; sy=t.clientY; active=true;
      }, {passive:true});
      viewer.addEventListener('touchmove', (e)=>{
        if(!active) return;
        const t=e.touches[0];
        const dx=t.clientX-sx;
        const dy=t.clientY-sy;
        if(Math.abs(dx)>Math.abs(dy) && Math.abs(dx)>18){
          active=false;
          if(dx<0) setMain(idx+1); else setMain(idx-1);
        }
      }, {passive:true});
      viewer.addEventListener('touchend', ()=>active=false, {passive:true});
    })();

    // lightbox
    const lb = document.getElementById('lb');
    const lbImg = document.getElementById('lbImg');
    const lbTitle = document.getElementById('lbTitle');
    document.getElementById('lbClose').addEventListener('click', ()=>lb.classList.remove('on'));
    lb.addEventListener('click', (e)=>{ if(e.target===lb) lb.classList.remove('on'); });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') lb.classList.remove('on'); });

    mainImg.addEventListener('click', ()=>{
      if(!imgs.length) return;
      lbTitle.textContent = `${HP_ID || 'Property'} Â· Photo ${idx+1}/${imgs.length}`;
      lbImg.src = imgs[idx];
      lb.classList.add('on');
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // DATA RENDER
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function render(p){
      const id    = p['HP_ID'] || HP_ID || 'â€”';
      const badge = (p['Badge'] || '').trim();
      const st    = (p['Status'] || 'Available').trim();
      const lt    = (p['Listing_Type'] || 'Sale').trim();

      const zone  = p['Zone'] || p['District'] || '';
      const proj  = p['Project_Name'] || '';
      const type  = p['Type'] || '';
      const name  = [proj, type].filter(Boolean).join(' Â· ') || id;

      const pts   = p['Key_Selling_Points'] || p['Description_Short'] || '';
      const desc  = p['Description'] || p['Full_Description'] || '';

      // header texts
      document.getElementById('title').textContent    = name;
      document.getElementById('subtitle').textContent = pts ? pts : 'Luxury Coastal Real Estate Â· Hua Hin';
      document.getElementById('zone').textContent     = zone ? ('ğŸ“ ' + zone) : 'â€”';
      document.getElementById('name').textContent     = name;
      document.getElementById('mini').textContent     = [p['Address'], p['SubDistrict'], p['District']].filter(Boolean).join(' Â· ') || 'â€”';

      // meta
      document.getElementById('pidBox').textContent   = id;
      document.getElementById('projBox').textContent  = proj || 'â€”';

      // chips
      const chips = document.getElementById('chips');
      chips.innerHTML = `
        ${badge ? `<span class="chip chip-badge">â˜… ${escapeHtml(badge)}</span>` : ''}
        <span class="chip"><span class="dot ${dotCls(st)}"></span>${escapeHtml(st)}</span>
        <span class="chip">${escapeHtml(lt)}</span>
      `;

      // price
      const pv = fmtPrice(p['Sale_Price'], p['Monthly_Rent'], lt);
      document.getElementById('priceVal').textContent = pv;
      document.getElementById('priceLbl').textContent = (lt === 'Rent') ? 'Monthly Rent' : 'Sale Price';

      // specs
      document.getElementById('vBeds').textContent   = (p['Bedrooms'] || 'â€”') + (p['Bedrooms'] ? ' Bed' : '');
      document.getElementById('vBaths').textContent  = (p['Bathrooms'] || 'â€”') + (p['Bathrooms'] ? ' Bath' : '');
      document.getElementById('vLiving').textContent = p['Living_Area_sq_m'] ? (p['Living_Area_sq_m'] + ' mÂ²') : (p['Living Area (sq.m)'] ? (p['Living Area (sq.m)']+' mÂ²') : 'â€”');

      const landW = p['Land_Area_sq_w'] || p['Land Area (sq.w)'] || '';
      const landM = p['Land_Area_sq_m'] || p['Land Area (sq.m)'] || '';
      document.getElementById('vLand').textContent = landW ? (landW + ' sq.w' + (landM ? (' Â· ' + landM + ' mÂ²') : '')) : (landM ? (landM + ' mÂ²') : 'â€”');

      const poolS = p['Pool_Size'] || p['Pool Size'] || '';
      const poolD = p['Pool_Depth'] || p['Pool Depth'] || '';
      document.getElementById('vPool').textContent = poolS ? (poolS + (poolD ? (' Â· ' + poolD) : '')) : (p['Pool'] || 'â€”');

      document.getElementById('vOwn').textContent = p['Ownership_Type'] || p['Ownership'] || 'â€”';

      // description
      document.getElementById('desc').textContent = desc || 'â€”';

      // extras
      const ex = p['Extras'] || p['Facilities'] || '';
      if (String(ex||'').trim()){
        document.getElementById('extrasSec').style.display = '';
        document.getElementById('extras').textContent = ex;
      }

      // links (FB / Map / Tour)
      const fb  = (p['FB_Link'] || '').trim();
      const map = (p['Map_Link'] || '').trim();
      const tour= (p['Virtual_Tour'] || '').trim();

      const linksRow = document.getElementById('linksRow');
      const linksSec = document.getElementById('linksSec');
      linksRow.innerHTML = '';

      const addLinkBtn = (label, url) => {
        const a = document.createElement('a');
        a.className = 'btn btn-wide';
        a.textContent = label;
        a.href = url;
        a.target = '_blank';
        a.rel = 'noopener';
        linksRow.appendChild(a);
      };

      if (fb) addLinkBtn('Facebook Post', fb);
      if (map) addLinkBtn('Google Maps', map);
      if (tour) addLinkBtn('Virtual Tour', tour);

      if (linksRow.children.length) linksSec.style.display = '';

      // PDFs
      const pdfRow = document.getElementById('pdfRow');
      const pdfSec = document.getElementById('pdfSec');
      pdfRow.innerHTML = '';
      const pdf1 = (p['Material_PDF'] || '').trim();
      const pdf2 = (p['FloorPlan_PDF'] || '').trim();

      function addPdf(label, url){
        const a = document.createElement('a');
        a.className='btn btn-wide';
        a.textContent=label;
        a.href=url;
        a.target='_blank';
        a.rel='noopener';
        pdfRow.appendChild(a);
      }
      if (pdf1) addPdf('Material PDF', pdf1);
      if (pdf2) addPdf('Floor Plan PDF', pdf2);
      if (pdfRow.children.length) pdfSec.style.display = '';

      // right contact buttons (defaults, but if you have per-listing phone/line you can map here)
      document.getElementById('btnLine').href = CONTACT.line;
      document.getElementById('btnWa').href   = CONTACT.wa;
      document.getElementById('btnFb').href   = fb || CONTACT.fb;
      document.getElementById('btnCall').href = CONTACT.tel;

      // map card
      const mapCard = document.getElementById('mapCard');
      const mapBox  = document.getElementById('mapBox');
      const btnMap  = document.getElementById('btnMap');
      const btnTour = document.getElementById('btnTour');

      if (map){
        mapCard.style.display = '';
        btnMap.href = map;

        // embed: if link is not embeddable, we still show iframe with a safe fallback
        const embed = makeGoogleMapsEmbed(map);
        mapBox.innerHTML = embed
          ? `<iframe loading="lazy" referrerpolicy="no-referrer-when-downgrade" allowfullscreen src="${embed}"></iframe>`
          : `<div style="height:100%;display:flex;align-items:center;justify-content:center;color:rgba(245,237,216,0.65);padding:14px;text-align:center;line-height:1.6">
               Map link is available.<br/>Tap â€œOpen Google Mapsâ€.
             </div>`;
      }

      if (tour){
        btnTour.style.display = '';
        btnTour.href = tour;
      }

      // album images:
      // Priority:
      // 1) API returns Image_List (links or fileIds)
      // 2) API returns Album_Images / Gallery / files_gallery etc (array)
      // 3) Fallback: Thumbnail_Image
      const listRaw =
        p['Image_List'] ||
        p['Album_Images'] ||
        p['Gallery'] ||
        p['files_gallery'] ||
        '';

      let arr = [];
      if (Array.isArray(listRaw)) arr = listRaw;
      else arr = splitList(listRaw);

      arr = arr.map(toLh3).filter(Boolean);

      // if empty: try thumbnail
      const thumb = toLh3((p['Thumbnail_Image'] || '').trim().replace(/^#$/,''));
      if (!arr.length && thumb) arr = [thumb];

      // if still empty: show empty state
      imgs = arr;

      if (!imgs.length){
        // no images
        skImg.style.display = 'none';
        mainImg.style.display = 'none';
        document.getElementById('imgCount').textContent = '0 Photos';
        thumbs.innerHTML = `<div style="color:rgba(245,237,216,0.55);font-size:.85rem;padding:2px 4px">No images</div>`;
      } else {
        renderThumbs();
        setMain(0);
      }
    }

    function escapeHtml(s){
      return String(s||'').replace(/[&<>"']/g, (m)=>(
        {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]
      ));
    }

    // Convert many Google Maps links into an embed URL (best-effort)
    function makeGoogleMapsEmbed(url){
      const u = String(url||'').trim();
      if(!u) return '';

      // already embed
      if (u.includes('google.com/maps/embed')) return u;

      // Short maps.app.goo.gl cannot be embedded reliably without resolving redirects (client-side canâ€™t).
      // We still show "Open Google Maps" button; iframe fallback will be disabled.
      if (u.includes('maps.app.goo.gl')) return '';

      // Place / search / query
      // If link has "q=" or "query=" we can embed via "search"
      try{
        const pu = new URL(u);
        const q = pu.searchParams.get('q') || pu.searchParams.get('query');
        if (q){
          return 'https://www.google.com/maps?q=' + encodeURIComponent(q) + '&output=embed';
        }
        // if has @lat,lng
        const at = u.match(/@(-?\d+(\.\d+)?),\s*(-?\d+(\.\d+)?)/);
        if (at){
          const lat = at[1], lng = at[3];
          return `https://www.google.com/maps?q=${encodeURIComponent(lat+','+lng)}&output=embed`;
        }
        // if has "place" path, embed with same URL + output=embed
        if (u.includes('google.com/maps')){
          return u + (u.includes('?') ? '&' : '?') + 'output=embed';
        }
      }catch(_){}
      return '';
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // FETCH DETAIL
    // à¸£à¸­à¸‡à¸£à¸±à¸š 2 à¹à¸šà¸š:
    // 1) mode=getUnitDetail&id=HP-xxxx  -> {ok:true,data:{...}}
    // 2) fallback: sheet/public not used here (detail needs backend)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    async function fetchDetail(){
      if(!HP_ID){
        showErr('à¹„à¸¡à¹ˆà¸à¸šà¸£à¸«à¸±à¸ªà¸šà¹‰à¸²à¸™à¹ƒà¸™ URL à¹€à¸Šà¹ˆà¸™ details.html?id=HP-0001');
        document.getElementById('title').textContent = 'Missing ID';
        document.getElementById('subtitle').textContent = 'à¸à¸£à¸¸à¸“à¸²à¹€à¸›à¸´à¸”à¸ˆà¸²à¸à¸«à¸™à¹‰à¸² index à¹à¸¥à¹‰à¸§à¸à¸”à¸£à¸²à¸¢à¸à¸²à¸£à¸šà¹‰à¸²à¸™';
        return;
      }

      try{
        const url = SCRIPT_URL + '?mode=getUnitDetail&id=' + encodeURIComponent(HP_ID) + '&albumFolderId=' + encodeURIComponent(ALBUM_FOLDER_ID);
        const r = await fetch(url, { signal: AbortSignal.timeout(9000) });
        if(!r.ok) throw new Error('http');
        const j = await r.json();

        // normalize payload
        const p = (j && (j.data || j.item || j.row || j.property)) ? (j.data || j.item || j.row || j.property) : null;
        if(!p || typeof p !== 'object') throw new Error('bad_payload');

        // IMPORTANT: If backend returns fileIds, this page converts to lh3 automatically via toLh3().
        render(p);
      }catch(err){
        showErr('à¹‚à¸«à¸¥à¸”à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¹„à¸¡à¹ˆà¹„à¸”à¹‰ â€” à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š SCRIPT_URL / Deploy / Permission à¹à¸¥à¸°à¹‚à¸«à¸¡à¸” getUnitDetail');
        document.getElementById('title').textContent = 'Load failed';
        document.getElementById('subtitle').textContent = 'à¸«à¸²à¸à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¹ƒà¸«à¹‰à¸£à¸¹à¸›à¸‚à¸¶à¹‰à¸™ à¸•à¹‰à¸­à¸‡à¹ƒà¸«à¹‰ API à¸ªà¹ˆà¸‡ Image_List à¹€à¸›à¹‡à¸™à¸¥à¸´à¸‡à¸à¹Œà¸«à¸£à¸·à¸­ File ID';
        // keep skeleton off
        skImg.style.display = 'none';
      }
    }

    // start
    fetchDetail();
  </script>

  <!--
    NOTE à¸ªà¸³à¸„à¸±à¸à¹€à¸£à¸·à¹ˆà¸­à¸‡ â€œà¸£à¸¹à¸›à¹„à¸¡à¹ˆà¸‚à¸¶à¹‰à¸™â€ (à¹à¸à¹‰à¸”à¹‰à¸§à¸¢à¹‚à¸„à¹‰à¸”à¸™à¸µà¹‰à¹à¸¥à¹‰à¸§):
    - à¸–à¹‰à¸² API à¸ªà¹ˆà¸‡ "File ID" à¸¡à¸² (à¹€à¸Šà¹ˆà¸™ 1AbC...xyz) à¹‚à¸„à¹‰à¸”à¸ˆà¸°à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹€à¸›à¹‡à¸™:
      https://lh3.googleusercontent.com/d/FILE_ID
    - à¸–à¹‰à¸² API à¸ªà¹ˆà¸‡à¸¥à¸´à¸‡à¸à¹Œà¹€à¸•à¹‡à¸¡ (http...) à¸à¹‡à¹ƒà¸Šà¹‰à¹„à¸”à¹‰à¹€à¸¥à¸¢
    - à¸–à¹‰à¸²à¸£à¸¹à¸›à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸‚à¸¶à¹‰à¸™ à¹à¸›à¸¥à¸§à¹ˆà¸²à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸™ Drive à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¹à¸Šà¸£à¹Œ â€œAnyone with the linkâ€ à¸«à¸£à¸·à¸­à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ Shared Drive à¸—à¸µà¹ˆà¸™à¹‚à¸¢à¸šà¸²à¸¢à¸šà¸¥à¹‡à¸­à¸
  -->
</body>
</html>
```
