<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Hua Hin Properties ¬∑ Details</title>
  <meta name="description" content="Hua Hin Properties ¬∑ Luxury Coastal Real Estate" />
  <link rel="preconnect" href="https://script.google.com">
  <link rel="preconnect" href="https://lh3.googleusercontent.com">
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400;1,600&family=Sarabun:wght@300;400;500;600&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --navy:#0B1829;
      --navy-mid:#112238;
      --navy-soft:#1a3350;
      --ocean:#1B4F72;
      --teal:#1A7A8A;
      --sand:#F5EDD8;
      --sand-dim:#C8B898;
      --gold:#C9A84C;
      --gold-lt:#E4C46A;
      --gold-glow:rgba(201,168,76,0.15);
      --white:#FDFAF5;
      --muted:#7A9BB5;
      --border:rgba(255,255,255,0.09);
      --card-bg:rgba(11,24,41,0.92);
      --available:#2ECC8A;
      --reserved:#E8A020;
      --sold:#E05555;
      --rented:#5B9BD5;
      --trans:0.32s cubic-bezier(0.4,0,0.2,1);
      --px:18px;
      --px-lg:52px;
      --radius:8px;
    }

    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    html{scroll-behavior:smooth;-webkit-tap-highlight-color:transparent}
    body{
      background:var(--navy);
      color:var(--sand);
      font-family:'Sarabun',sans-serif;
      font-weight:300;
      min-height:100dvh;
      overflow-x:hidden;
    }

    body::before{
      content:'';
      position:fixed;inset:0;
      background:
        radial-gradient(ellipse 80% 60% at 50% -10%, rgba(27,79,114,0.5) 0%, transparent 60%),
        radial-gradient(ellipse 60% 40% at 100% 80%, rgba(26,122,138,0.2) 0%, transparent 50%),
        radial-gradient(ellipse 50% 50% at 0% 100%, rgba(11,24,41,0.8) 0%, transparent 60%),
        linear-gradient(180deg, #060F1A 0%, #0B1829 40%, #0D1F35 100%);
      pointer-events:none;
      z-index:0;
    }

    header{
      position:fixed;top:0;left:0;right:0;z-index:300;
      height:58px;
      display:flex;align-items:center;justify-content:space-between;
      padding:0 var(--px);
      background:rgba(6,15,26,0.88);
      backdrop-filter:blur(20px);
      -webkit-backdrop-filter:blur(20px);
      border-bottom:1px solid var(--border);
    }
    .logo{
      font-family:'Cormorant Garamond',serif;
      font-size:1.05rem;font-weight:400;
      letter-spacing:0.1em;text-transform:uppercase;
      color:var(--gold);text-decoration:none;
      line-height:1;
    }
    .logo span{color:var(--sand);font-style:italic;font-weight:300}
    .header-nav{display:flex;align-items:center;gap:10px}

    .btn{
      display:inline-flex;align-items:center;justify-content:center;
      gap:8px;
      padding:9px 14px;
      border-radius:2px;
      border:1px solid rgba(201,168,76,0.35);
      color:var(--gold);
      background:transparent;
      font-family:'Montserrat',sans-serif;
      font-size:0.62rem;font-weight:600;
      letter-spacing:0.16em;text-transform:uppercase;
      text-decoration:none;
      transition:all var(--trans);
      white-space:nowrap;
      cursor:pointer;
    }
    .btn.primary{
      border-color:transparent;
      background:linear-gradient(135deg,var(--gold),var(--gold-lt));
      color:var(--navy);
    }

    main{position:relative;z-index:1;padding:86px var(--px) 80px}
    .err{
      display:none;
      background:rgba(224,85,85,.1);
      border:1px solid rgba(224,85,85,.3);
      color:#ef9090;
      padding:12px 14px;
      border-radius:var(--radius);
      margin-bottom:14px;
      font-size:.88rem;
      line-height:1.4;
    }

    .wrap{display:grid;grid-template-columns:1fr;gap:14px;align-items:start}
    .card{
      background:var(--card-bg);
      border:1px solid var(--border);
      border-radius:var(--radius);
      overflow:hidden;
      backdrop-filter:blur(12px);
    }

    /* ===== GALLERY ===== */
    .gallery{position:relative}
    .g-main{
      position:relative;width:100%;
      aspect-ratio:16/9;background:#060F1A;overflow:hidden;
    }
    .g-main img{width:100%;height:100%;object-fit:cover;display:block;filter:brightness(0.9) saturate(1.05)}
    .g-shade{
      position:absolute;inset:0;
      background:linear-gradient(to bottom, rgba(0,0,0,0) 40%, rgba(11,24,41,0.45) 75%, rgba(11,24,41,0.85) 100%);
      pointer-events:none;
    }

    .g-badge{
      position:absolute;top:10px;left:10px;
      padding:4px 10px;border-radius:2px;
      background:linear-gradient(135deg,var(--gold),var(--gold-lt));
      color:var(--navy);
      font-family:'Montserrat',sans-serif;
      font-size:0.5rem;font-weight:700;letter-spacing:0.18em;text-transform:uppercase;
    }

    /* status ‡∏ö‡∏≤‡∏á‡πÜ */
    .g-status{
      position:absolute;top:10px;right:10px;
      display:flex;align-items:center;gap:6px;
      padding:4px 10px;border-radius:20px;
      background:rgba(6,15,26,0.18);
      border:1px solid rgba(255,255,255,0.12);
      backdrop-filter:blur(4px);
      -webkit-backdrop-filter:blur(4px);
    }
    .dot{width:6px;height:6px;border-radius:50%}
    .d-av{background:#2ECC8A;box-shadow:0 0 8px rgba(46,204,138,0.55)}
    .d-rs{background:#E8A020;box-shadow:0 0 8px rgba(232,160,32,0.55)}
    .d-sd{background:#E05555;box-shadow:0 0 8px rgba(224,85,85,0.55)}
    .d-rt{background:#5B9BD5;box-shadow:0 0 8px rgba(91,155,213,0.55)}
    .dot-lbl{
      font-family:'Montserrat',sans-serif;
      font-size:0.52rem;letter-spacing:0.1em;text-transform:uppercase;
      color:rgba(245,237,216,0.92);
    }

    .g-nav{
      position:absolute;inset:0;display:flex;align-items:center;justify-content:space-between;
      padding:0 14px;pointer-events:none;
    }
    .g-btn{
      pointer-events:auto;
      width:42px;height:42px;border-radius:50%;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(6,15,26,0.35);
      backdrop-filter:blur(8px);
      -webkit-backdrop-filter:blur(8px);
      display:flex;align-items:center;justify-content:center;
      color:var(--sand);
      cursor:pointer;
    }

    /* ==============================
       ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 1: ‡∏£‡∏≤‡∏Ñ‡∏≤ = ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ "‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß"
       - ‡πÄ‡∏≠‡∏≤‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ Sale Price ‡∏≠‡∏≠‡∏Å
       - ‡πÄ‡∏≠‡∏≤‡πÅ‡∏ñ‡∏ö/‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ö‡∏≤‡∏á‡πÜ‡∏≠‡∏≠‡∏Å (‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô transparent)
       - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô font ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ (Montserrat)
       ============================== */
    .g-price{
      position:absolute;
      left:12px;bottom:12px;
      padding:0;               /* ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πà‡∏≠‡∏á */
      min-width:0;
      background:transparent;  /* ‡πÄ‡∏≠‡∏≤‡πÅ‡∏ñ‡∏ö‡∏ö‡∏≤‡∏á‡πÜ‡∏≠‡∏≠‡∏Å */
      border:none;
      backdrop-filter:none;
      -webkit-backdrop-filter:none;
      text-shadow:0 2px 10px rgba(0,0,0,0.55);
    }
    .g-price .lbl{display:none !important;} /* ‡πÄ‡∏≠‡∏≤ label ‡∏≠‡∏≠‡∏Å */
    .g-price .val{
      font-family:'Montserrat',sans-serif; /* font ‡πÉ‡∏´‡∏°‡πà ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ */
      font-size:1.35rem;
      font-weight:600;
      line-height:1;
      color:#ffffff;            /* ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î */
      letter-spacing:0.01em;
    }

    /* ==============================
       ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 2: ‡πÅ‡∏ñ‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏π‡∏õ = ‡πÄ‡∏≠‡∏≤‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏≠‡∏≠‡∏Å + ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 1/2, 2/2, 1/10...
       - ‡∏Ñ‡∏á‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°
       ============================== */
    .g-count{
      position:absolute;
      right:12px;bottom:12px;
      padding:0;               /* ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πà‡∏≠‡∏á */
      border:none;
      background:transparent;  /* ‡πÄ‡∏≠‡∏≤ Tab ‡∏ö‡∏≤‡∏á‡πÜ‡∏≠‡∏≠‡∏Å */
      backdrop-filter:none;
      -webkit-backdrop-filter:none;
      font-family:'Montserrat',sans-serif;
      font-size:0.55rem;       /* ‡∏Ñ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° */
      letter-spacing:0.12em;
      text-transform:uppercase;
      color:rgba(245,237,216,0.95);
      text-shadow:0 2px 10px rgba(0,0,0,0.55);
    }

    .thumbs{
      display:flex;gap:8px;padding:10px 12px 12px;overflow-x:auto;scrollbar-width:none;
      background:rgba(6,15,26,0.25);border-top:1px solid var(--border);
    }
    .thumbs::-webkit-scrollbar{display:none}
    .t{
      flex:0 0 auto;width:86px;height:56px;border-radius:8px;overflow:hidden;
      border:1px solid rgba(255,255,255,0.12);
      background:#060F1A;cursor:pointer;opacity:.9;transition:all var(--trans);
    }
    .t img{width:100%;height:100%;object-fit:cover;display:block}
    .t.active{border-color:rgba(201,168,76,0.7);box-shadow:0 0 0 3px var(--gold-glow);opacity:1;transform:translateY(-1px)}

    /* ===== RIGHT SIDE (‡πÄ‡∏î‡∏¥‡∏°) ===== */
    .pad{padding:14px 16px}
    .kicker{font-family:'Montserrat',sans-serif;font-size:0.56rem;letter-spacing:0.28em;text-transform:uppercase;color:var(--teal);margin-bottom:6px}
    .title{font-family:'Cormorant Garamond',serif;font-size:1.45rem;font-weight:400;line-height:1.2;color:var(--white);margin-bottom:8px}
    .sub{font-size:.86rem;color:var(--muted);line-height:1.6;margin-bottom:12px}
    .chips{display:flex;flex-wrap:wrap;gap:6px;margin:10px 0 2px}
    .chip{
      padding:5px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.04);color:rgba(245,237,216,0.82);
      font-family:'Montserrat',sans-serif;font-size:0.56rem;letter-spacing:0.10em;text-transform:uppercase;
    }
    .grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:12px}
    .spec{border:1px solid rgba(255,255,255,0.10);background:rgba(6,15,26,0.35);border-radius:10px;padding:10px 10px;min-height:62px}
    .spec .s-lbl{font-family:'Montserrat',sans-serif;font-size:0.52rem;letter-spacing:0.22em;text-transform:uppercase;color:var(--gold);opacity:.9;margin-bottom:6px}
    .spec .s-val{font-size:.9rem;color:rgba(245,237,216,0.92);line-height:1.2;word-break:break-word}
    .divider{height:1px;background:linear-gradient(to right, transparent, var(--border), transparent);margin:14px 0}
    .smallCard{padding:14px 16px}
    .kv{display:grid;grid-template-columns:140px 1fr;gap:8px 12px;align-items:start}
    .k{font-family:'Montserrat',sans-serif;font-size:0.55rem;letter-spacing:0.22em;text-transform:uppercase;color:rgba(201,168,76,0.92)}
    .v{color:rgba(245,237,216,0.9);font-size:.92rem;line-height:1.35;word-break:break-word}
    .desc{font-size:.92rem;color:rgba(245,237,216,0.88);line-height:1.8;white-space:pre-line}

    .contactBox .pad{padding:14px 16px}
    .contactGrid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    .cbtn{
      display:flex;align-items:center;justify-content:center;height:36px;border-radius:2px;
      border:1px solid rgba(201,168,76,0.35);color:var(--gold);
      font-family:'Montserrat',sans-serif;font-size:0.6rem;letter-spacing:0.18em;text-transform:uppercase;
      text-decoration:none;transition:all var(--trans);background:rgba(6,15,26,0.35);
    }
    .cbtn.primary{border-color:transparent;background:linear-gradient(135deg,var(--gold),var(--gold-lt));color:var(--navy);font-weight:700}
    .note{margin-top:10px;font-size:.84rem;color:var(--muted);line-height:1.55}

    @media (min-width:900px){
      header{padding:0 var(--px-lg)}
      main{padding:92px var(--px-lg) 96px}
      .wrap{grid-template-columns:1.2fr 0.8fr;gap:16px}
    }
    @media (max-width:520px){
      .g-price{left:10px;bottom:10px}
      .g-price .val{font-size:1.18rem}
      .g-count{right:10px;bottom:10px;font-size:0.55rem}
    }
  </style>
</head>

<body>
  <header>
    <a href="index.html" class="logo">Hua Hin<span>.Properties</span></a>
    <div class="header-nav">
      <button class="btn" id="btnBack" type="button">‚Üê Back</button>
      <a class="btn primary" href="contact.html">Contact</a>
    </div>
  </header>

  <main>
    <div class="err" id="errBox">‚ö† ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‚Äî ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö SCRIPT_URL / Deploy / Permission ‡πÅ‡∏•‡∏∞‡πÇ‡∏´‡∏°‡∏î getUnitDetail</div>

    <div class="wrap">
      <!-- LEFT: GALLERY -->
      <section class="card gallery" aria-label="Gallery">
        <div class="g-main" id="gMain">
          <div class="g-shade"></div>

          <div class="g-badge" id="gBadge" style="display:none"></div>

          <div class="g-status" id="gStatus" style="display:none">
            <span class="dot" id="gDot"></span>
            <span class="dot-lbl" id="gStatusLbl">Available</span>
          </div>

          <div class="g-nav">
            <button class="g-btn" id="prevBtn" type="button" aria-label="Previous">‚Äπ</button>
            <button class="g-btn" id="nextBtn" type="button" aria-label="Next">‚Ä∫</button>
          </div>

          <div class="g-price">
            <div class="lbl" id="priceLbl">Sale Price</div>
            <div class="val" id="priceVal">‚Äî</div>
          </div>

          <div class="g-count" id="gCount">1/1</div>
        </div>

        <div class="thumbs" id="thumbs"></div>
      </section>

      <!-- RIGHT -->
      <aside style="display:grid;gap:14px">
        <section class="card">
          <div class="pad">
            <div class="kicker">Property</div>
            <div class="title" id="ttl">‚Äî</div>
            <div class="sub" id="sub">‚Äî</div>
            <div class="chips" id="chips"></div>

            <div class="grid3">
              <div class="spec"><div class="s-lbl">Bedrooms</div><div class="s-val" id="bed">‚Äî</div></div>
              <div class="spec"><div class="s-lbl">Bathrooms</div><div class="s-val" id="bath">‚Äî</div></div>
              <div class="spec"><div class="s-lbl">Living Area</div><div class="s-val" id="liv">‚Äî</div></div>
            </div>

            <div class="grid3" style="margin-top:10px">
              <div class="spec"><div class="s-lbl">Land</div><div class="s-val" id="land">‚Äî</div></div>
              <div class="spec"><div class="s-lbl">Pool</div><div class="s-val" id="pool">‚Äî</div></div>
              <div class="spec"><div class="s-lbl">Ownership</div><div class="s-val" id="own">‚Äî</div></div>
            </div>

            <div class="divider"></div>

            <div class="kv">
              <div class="k">Property ID</div><div class="v" id="pid">‚Äî</div>
              <div class="k">Project</div><div class="v" id="proj">‚Äî</div>
              <div class="k">Zone</div><div class="v" id="zone">‚Äî</div>
              <div class="k">Map</div><div class="v"><a id="mapLink" href="#" target="_blank" rel="noopener" style="color:var(--gold);text-decoration:none;border-bottom:1px dashed rgba(201,168,76,0.6)">Open Map ‚Üí</a></div>
              <div class="k">Virtual Tour</div><div class="v"><a id="vtLink" href="#" target="_blank" rel="noopener" style="color:var(--gold);text-decoration:none;border-bottom:1px dashed rgba(201,168,76,0.6)">Open Tour ‚Üí</a></div>
            </div>
          </div>
        </section>

        <section class="card">
          <div class="smallCard">
            <div class="kicker">Key Selling Points</div>
            <div class="desc" id="ksp">‚Äî</div>
            <div class="divider"></div>
            <div class="kicker">Description</div>
            <div class="desc" id="desc">‚Äî</div>
          </div>
        </section>

        <section class="card contactBox">
          <div class="pad">
            <div class="kicker">Contact</div>
            <div class="contactGrid">
              <a class="cbtn primary" id="btnLine" href="https://line.me/R/ti/p/@qap7218t" target="_blank" rel="noopener">Line OA</a>
              <a class="cbtn" id="btnWa" href="https://wa.me/66805820777?text=Interested" target="_blank" rel="noopener">WhatsApp</a>
              <a class="cbtn" id="btnFb" href="#" target="_blank" rel="noopener">Facebook</a>
              <a class="cbtn" id="btnCall" href="tel:+66805820777">Call</a>
            </div>
            <div class="note">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î / ‡∏ô‡∏±‡∏î‡∏ä‡∏°‡∏ö‡πâ‡∏≤‡∏ô<br/>(‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà)</div>
          </div>
        </section>
      </aside>
    </div>
  </main>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec";

    const qs = new URLSearchParams(location.search);
    const HP_ID = (qs.get("id") || "").trim();

    document.getElementById("btnBack").addEventListener("click", () => {
      if (history.length > 1) history.back();
      else location.href = "index.html";
    });

    function jsonp(url) {
      return new Promise((resolve, reject) => {
        const cb = "__cb_" + Math.random().toString(16).slice(2);
        const s = document.createElement("script");
        const t = setTimeout(() => { cleanup(); reject(new Error("timeout")); }, 9000);

        function cleanup() {
          clearTimeout(t);
          if (s && s.parentNode) s.parentNode.removeChild(s);
          try { delete window[cb]; } catch(_) { window[cb] = undefined; }
        }

        window[cb] = (data) => { cleanup(); resolve(data); };
        s.onerror = () => { cleanup(); reject(new Error("jsonp_error")); };
        s.src = url + (url.includes("?") ? "&" : "?") + "callback=" + encodeURIComponent(cb);
        document.body.appendChild(s);
      });
    }

    function showErr(msg) {
      const e = document.getElementById("errBox");
      e.textContent = "‚ö† " + msg;
      e.style.display = "block";
    }

    function safeText(v, fb="‚Äî") {
      const s = (v==null) ? "" : String(v).trim();
      return s ? s : fb;
    }

    function parseAlbum(v) {
      const s = (v==null) ? "" : String(v).trim();
      if (!s) return [];
      return s.split(/[,|\n]/).map(x=>String(x).trim()).filter(Boolean);
    }

    function moneyFull(value){
      const raw = (value==null) ? "" : String(value).trim();
      if (!raw || raw === "#") return "";
      const n = parseFloat(raw.replace(/[^\d.]/g,""));
      if (!n || !isFinite(n)) return "";
      return "‡∏ø" + Math.round(n).toLocaleString("en-US");
    }

    function pickPriceFull(sale, rent, listingType){
      const lt = (listingType||"").toLowerCase();
      if (lt === "rent") {
        const r = moneyFull(rent);
        return r ? (r + " / month") : "";
      }
      const s = moneyFull(sale);
      if (s) return s;
      const r = moneyFull(rent);
      return r ? (r + " / month") : "";
    }

    function dotCls(s) {
      return { Available:"d-av", Reserved:"d-rs", Sold:"d-sd", Rented:"d-rt" }[s] || "d-av";
    }

    // ===== GALLERY STATE =====
    let ALBUM = [];
    let CUR = 0;

    function updateCounter(){
      // ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 2: 1/2, 2/2, 1/10...
      const total = ALBUM.length || 1;
      const current = Math.min(Math.max(CUR + 1, 1), total);
      document.getElementById("gCount").textContent = `${current}/${total}`;
    }

    function setMain(i) {
      if (!ALBUM.length) {
        CUR = 0;
        updateCounter();
        return;
      }
      CUR = (i + ALBUM.length) % ALBUM.length;

      const main = document.getElementById("gMain");
      const old = main.querySelector("img");
      if (old) old.remove();

      const img = document.createElement("img");
      img.src = ALBUM[CUR];
      img.alt = "property image " + (CUR+1);
      img.loading = "eager";
      img.onerror = () => { img.style.display = "none"; };
      main.insertBefore(img, main.firstChild);

      updateCounter();

      document.querySelectorAll(".t").forEach((el, idx) => {
        if (idx === CUR) el.classList.add("active");
        else el.classList.remove("active");
      });
    }

    function buildThumbs() {
      const wrap = document.getElementById("thumbs");
      wrap.innerHTML = "";

      if (!ALBUM.length) {
        wrap.innerHTML = `<div style="padding:10px 4px;color:rgba(122,155,181,0.85);font-size:.9rem">No photos</div>`;
        updateCounter();
        return;
      }

      ALBUM.forEach((url, i) => {
        const d = document.createElement("div");
        d.className = "t" + (i===0 ? " active" : "");
        d.innerHTML = `<img src="${url}" alt="thumb ${i+1}" loading="lazy">`;
        d.addEventListener("click", () => setMain(i));
        wrap.appendChild(d);
      });
    }

    document.getElementById("prevBtn").addEventListener("click", () => setMain(CUR - 1));
    document.getElementById("nextBtn").addEventListener("click", () => setMain(CUR + 1));

    function render(p) {
      const name = [p.Project_Name, p.Type].filter(Boolean).join(" ¬∑ ");
      document.getElementById("ttl").textContent = safeText(name);
      document.getElementById("sub").textContent = "üìç " + [p.Zone, p.District].filter(Boolean).join(" ¬∑ ");

      const chips = document.getElementById("chips");
      chips.innerHTML = "";
      [p.Listing_Type, p.Status, p.View_Type, p.Land_Title_Deed_Type].filter(Boolean).slice(0,4).forEach(t=>{
        const c = document.createElement("div");
        c.className = "chip";
        c.textContent = t;
        chips.appendChild(c);
      });

      const badge = safeText(p.Badge, "");
      const st = safeText(p.Status, "Available");
      if (badge) {
        const b = document.getElementById("gBadge");
        b.style.display = "block";
        b.textContent = badge;
      }
      const gs = document.getElementById("gStatus");
      gs.style.display = "flex";
      document.getElementById("gStatusLbl").textContent = st;
      document.getElementById("gDot").className = "dot " + dotCls(st);

      const lt = safeText(p.Listing_Type, "Sale");
      const full = pickPriceFull(p.Sale_Price, p.Monthly_Rent, lt);
      // ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 1: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
      document.getElementById("priceVal").textContent = full || "‚Äî";

      document.getElementById("bed").textContent  = safeText(p.Bedrooms);
      document.getElementById("bath").textContent = safeText(p.Bathrooms);
      document.getElementById("liv").textContent  = p.Living_Area_sq_m ? `${p.Living_Area_sq_m} m¬≤` : "‚Äî";

      const landW = p.Land_Area_sq_w ? `${p.Land_Area_sq_w} sq.w` : "";
      const landM = p.Land_Area_sq_m ? `${p.Land_Area_sq_m} m¬≤` : "";
      document.getElementById("land").textContent = [landW, landM].filter(Boolean).join(" ¬∑ ") || "‚Äî";

      const pool = [p.Pool_Size, p.Pool_Depth].filter(Boolean).join(" ¬∑ ");
      document.getElementById("pool").textContent = pool || "‚Äî";
      document.getElementById("own").textContent  = [p.Ownership_Type, p.Transfer_Expenses].filter(Boolean).join(" ¬∑ ") || "‚Äî";

      document.getElementById("pid").textContent  = safeText(p.HP_ID);
      document.getElementById("proj").textContent = safeText(p.Project_Name);
      document.getElementById("zone").textContent = safeText(p.Zone);

      const fb = safeText(p.FB_Link, "");
      const map = safeText(p.Map_Link, "");
      const vt  = safeText(p.Virtual_Tour, "");

      const btnFb = document.getElementById("btnFb");
      btnFb.style.opacity = fb ? "1" : ".45";
      btnFb.style.pointerEvents = fb ? "auto" : "none";
      btnFb.href = fb || "#";

      const mapA = document.getElementById("mapLink");
      mapA.style.opacity = map ? "1" : ".45";
      mapA.style.pointerEvents = map ? "auto" : "none";
      mapA.href = map || "#";

      const vtA = document.getElementById("vtLink");
      vtA.style.opacity = vt ? "1" : ".45";
      vtA.style.pointerEvents = vt ? "auto" : "none";
      vtA.href = vt || "#";

      document.getElementById("ksp").textContent  = safeText(p.Key_Selling_Points);
      document.getElementById("desc").textContent = safeText(p.Description);

      const a2 = parseAlbum(p.Album_Image);
      ALBUM = a2.filter(Boolean);

      const thumb = safeText(p.Thumbnail_Image, "");
      if (!ALBUM.length && thumb) ALBUM = [thumb];

      buildThumbs();
      setMain(0); // ‡∏à‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï 1/total ‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏á
    }

    async function load() {
      if (!HP_ID) {
        showErr("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå id ‡πÄ‡∏ä‡πà‡∏ô details.html?id=HP00-0001");
        return;
      }
      try {
        const url = `${SCRIPT_URL}?mode=getUnitDetail&id=${encodeURIComponent(HP_ID)}`;
        const j = await jsonp(url);
        if (!j || !j.ok) throw new Error((j && j.error) ? j.error : "load_failed");
        render(j.data || {});
      } catch (e) {
        showErr("‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‚Äî ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Deploy Web App (Anyone) ‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î: SCRIPT_URL?mode=getUnitDetail&id=" + encodeURIComponent(HP_ID));
      }
    }

    load();
  </script>
</body>
</html>
