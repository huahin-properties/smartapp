<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Hua Hin Properties ¬∑ Details</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
<style>
  :root{ --navy:#0B1829; --gold:#C9A84C; --gold-lt:#E4C46A; --white:#FDFAF5; --muted:#7A9BB5; --border:rgba(255, 255, 255, 0.08); --card-bg:rgba(11, 24, 41, 0.92); }
  *{box-sizing:border-box; margin:0; padding:0}
  body{ background:var(--navy); color:var(--white); font-family:'Sarabun',sans-serif; min-height:100dvh; overflow-x:hidden; }
  body::before { content:''; position:fixed; inset:0; background: radial-gradient(ellipse 80% 60% at 50% -10%, rgba(27,79,114,0.4) 0%, transparent 60%); z-index:0; }
  header { position:fixed; top:0; left:0; right:0; z-index:1000; height:60px; display:flex; align-items:center; justify-content:space-between; padding:0 15px; background:rgba(6,15,26,0.9); backdrop-filter:blur(15px); border-bottom:1px solid var(--border); }
  .backBtn { padding:8px 16px; border-radius:50px; background:rgba(255,255,255,0.05); border:1px solid var(--border); color:var(--white); cursor:pointer; }
  main { position:relative; z-index:1; padding:75px 15px 40px; max-width:1100px; margin:0 auto; }
  
  /* GALLERY SYSTEM */
  .gallery-card { background:var(--card-bg); border-radius:18px; border:1px solid var(--border); overflow:hidden; margin-bottom:15px; box-shadow:0 15px 35px rgba(0,0,0,0.5); }
  .main-stage { position:relative; width:100%; aspect-ratio:16/10; background:#000; overflow:hidden; }
  .main-img { width:100%; height:100%; object-fit:cover; transition:opacity 0.3s; }
  .nav-arrow { position:absolute; top:50%; transform:translateY(-50%); width:44px; height:44px; border-radius:50%; background:rgba(0,0,0,0.3); color:white; border:1px solid rgba(255,255,255,0.1); display:flex; align-items:center; justify-content:center; cursor:pointer; z-index:10; }
  .tag-price { position:absolute; left:15px; bottom:15px; font-size:1.4rem; font-weight:800; color:var(--gold-lt); text-shadow:0 2px 10px rgba(0,0,0,0.8); }
  .tag-count { position:absolute; right:15px; bottom:15px; background:rgba(0,0,0,0.6); padding:4px 10px; border-radius:50px; font-size:12px; }
  .thumb-row { display:flex; gap:10px; padding:12px; overflow-x:auto; background:rgba(0,0,0,0.2); scrollbar-width:none; }
  .thumb { width:90px; aspect-ratio:16/10; border-radius:8px; object-fit:cover; opacity:0.5; cursor:pointer; border:2px solid transparent; flex-shrink:0; }
  .thumb.active { opacity:1; border-color:var(--gold); }

  /* INFO SECTION */
  .info-panel { background:var(--card-bg); border-radius:18px; padding:20px; border:1px solid var(--border); }
  .grid-specs { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-top:20px; }
  .spec-box { background:rgba(255,255,255,0.03); border:1px solid var(--border); border-radius:12px; padding:12px; text-align:center; }
  .desc-text { margin-top:20px; border-top:1px solid var(--border); padding-top:15px; line-height:1.7; color:var(--muted); white-space:pre-wrap; }
  .grid-details { display:grid; grid-template-columns:1fr; gap:12px; margin-top:20px; }
  @media(min-width:600px){ .grid-details { grid-template-columns:1fr 1fr; } }
  .detail-item { display:flex; justify-content:space-between; padding:10px; background:rgba(0,0,0,0.1); border-radius:8px; font-size:0.85rem; }

  body.mode-focus header { display: none !important; }
  body.mode-focus main { padding-top: 20px !important; }
</style>
</head>
<body>
  <div id="loader" style="position:fixed; inset:0; background:var(--navy); z-index:9999; display:flex; align-items:center; justify-content:center;">Loading...</div>
  <header><a href="index.html" style="color:var(--gold); text-decoration:none; font-weight:700;">HUA HIN PROPERTIES</a><button class="backBtn" onclick="history.back()">‚Üê Back</button></header>
  <main>
    <div class="gallery-card">
      <div class="main-stage" id="galleryStage">
        <img id="mainImg" class="main-img" src=""><div class="nav-arrow" style="left:10px" onclick="changeSlide(-1)">‚ùÆ</div><div class="nav-arrow" style="right:10px" onclick="changeSlide(1)">‚ùØ</div>
        <div class="tag-price" id="priceLabel">‡∏ø0</div><div class="tag-count" id="countLabel">0 / 0</div>
      </div>
      <div class="thumb-row" id="thumbStrip"></div>
    </div>
    <div class="info-panel">
      <h1 id="propTitle" style="font-size:1.5rem; margin-bottom:5px;">-</h1><div id="propLoc" style="color:var(--muted); font-size:0.9rem;">üìç -</div>
      <div class="grid-specs">
        <div class="spec-box"><div style="font-size:0.6rem; color:var(--gold);">BEDS</div><div id="vBed" style="font-weight:700;">-</div></div>
        <div class="spec-box"><div style="font-size:0.6rem; color:var(--gold);">BATHS</div><div id="vBath" style="font-weight:700;">-</div></div>
        <div class="spec-box"><div style="font-size:0.6rem; color:var(--gold);">AREA</div><div id="vArea" style="font-weight:700;">-</div></div>
      </div>
      <div class="desc-text" id="descContent">-</div>
      <div class="grid-details" id="detailGrid"></div>
    </div>
  </main>
<script>
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec';
const qs = new URLSearchParams(window.location.search);
const hpId = qs.get("id");
if (qs.get("mode") === "focus") document.body.classList.add('mode-focus');
let images = [], idx = 0;

async function init() {
  if (!hpId) return;
  try {
    const res = await fetch(`${SCRIPT_URL}?mode=getUnitDetail&id=${hpId}`);
    const json = await res.json();
    if (json.ok) render(json.data);
  } catch (e) { console.error(e); }
  document.getElementById('loader').style.display = 'none';
}

function render(p) {
  document.getElementById('propTitle').textContent = p.Project_Name || p.HP_ID;
  document.getElementById('propLoc').textContent = `üìç ${p.Zone}, ${p.District}`;
  document.getElementById('priceLabel').textContent = "‡∏ø" + (parseFloat(String(p.Sale_Price).replace(/[^0-9.]/g,'')) || 0).toLocaleString();
  document.getElementById('vBed').textContent = p.Bedrooms;
  document.getElementById('vBath').textContent = p.Bathrooms;
  document.getElementById('vArea').textContent = p.Living_Area_sq_m + " m¬≤";
  document.getElementById('descContent').textContent = p.Key_Selling_Points || p.Description || "No description provided.";
  
  const specs = [
    ["Property ID", p.HP_ID], ["Status", p.Status], ["Land Area", p.Land_Area_sq_m + " m¬≤"],
    ["Pool Size", p.Pool_Size], ["View Type", p.View_Type], ["Year Built", p.Year_Built]
  ];
  document.getElementById('detailGrid').innerHTML = specs.map(([k,v]) => `<div class="detail-item"><span style="color:var(--muted)">${k}</span><span>${v||'-'}</span></div>`).join('');

  images = p.__album || [];
  if (images.length > 0) { renderThumbs(); setMain(0); }
}

function setMain(i) {
  idx = (i + images.length) % images.length;
  document.getElementById('mainImg').src = images[idx];
  document.getElementById('countLabel').textContent = `${idx + 1} / ${images.length}`;
  document.querySelectorAll('.thumb').forEach((t, k) => t.classList.toggle('active', k === idx));
}
function changeSlide(n) { setMain(idx + n); }
function renderThumbs() {
  document.getElementById('thumbStrip').innerHTML = images.map((src, i) => `<img class="thumb" src="${src}" onclick="setMain(${i})">`).join('');
}
init();
</script>
</body>
</html>
