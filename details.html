<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Hua Hin Properties Â· Details</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600&family=Sarabun:wght@300;400;500;600&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>

  <style>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HUAHIN.PROPERTIES â€” DETAILS (FULL VERSION)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    :root{
      --navy:#0B1829; --navy-mid:#112238; --muted:#7A9BB5; --border:rgba(255,255,255,0.09);
      --card-bg:rgba(11,24,41,0.92); --brand-gold:#CEA86C; --brand-gold-hi:#EBD18E;
      --brand-cream:#F8F3E2; --white:#FDFAF5; --available:#2ECC8A;
      --reserved:#E8A020; --sold:#E05555; --rented:#5B9BD5;
      --trans:0.32s cubic-bezier(0.4,0,0.2,1); --px:18px; --radius:10px;
    }

    * { box-sizing:border-box; margin:0; padding:0 }
    body { background:var(--navy); color:var(--brand-cream); font-family:'Sarabun',sans-serif; font-weight:300; min-height:100dvh; overflow-x:hidden; }
    body::before { content:''; position:fixed; inset:0; background: radial-gradient(ellipse 80% 60% at 50% -10%, rgba(27,79,114,0.5) 0%, transparent 60%), linear-gradient(180deg, #060F1A 0%, #0B1829 40%, #0D1F35 100%); z-index:0; }

    header { position:fixed; top:0; left:0; right:0; z-index:300; height:58px; display:flex; align-items:center; justify-content:space-between; padding:0 var(--px); background:rgba(6,15,26,0.88); backdrop-filter:blur(20px); border-bottom:1px solid var(--border); }
    .logo { font-family:'Cormorant Garamond',serif; font-size:1.1rem; color:var(--brand-gold); text-decoration:none; text-transform:uppercase; letter-spacing:0.1em; }
    .btn-top { padding:9px 16px; border-radius:2px; border:1px solid rgba(206,168,108,.35); color:var(--brand-gold); font-size:0.62rem; font-weight:600; text-decoration:none; text-transform:uppercase; }
    .btn-cta { padding:9px 16px; border-radius:2px; background:linear-gradient(135deg,var(--brand-gold),var(--brand-gold-hi)); color:var(--navy); font-size:0.62rem; font-weight:700; text-decoration:none; text-transform:uppercase; }

    /* FOCUS MODE STYLES */
    body.mode-focus header { display: none !important; }
    body.mode-focus main { padding-top: 20px !important; }

    main { position:relative; z-index:1; padding:78px var(--px) 80px; max-width:1100px; margin:0 auto; }
    .panel { background:var(--card-bg); border:1px solid rgba(206,168,108,.22); border-radius:var(--radius); overflow:hidden; backdrop-filter:blur(12px); margin-bottom: 14px; }
    
    .hero-media { position:relative; width:100%; aspect-ratio:16/9; background:#060F1A; overflow:hidden; }
    .hero-media img { width:100%; height:100%; object-fit:cover; opacity: 1; transition: opacity 0.3s; }
    .navBtn { position:absolute; top:50%; transform:translateY(-50%); width:44px; height:44px; border-radius:50%; border:1px solid rgba(255,255,255,.14); background:rgba(6,15,26,.18); color:white; display:flex; align-items:center; justify-content:center; cursor:pointer; }
    .priceOnly { position:absolute; left:14px; bottom:14px; font-weight:700; font-size:1.06rem; color:white; text-shadow:0 2px 10px rgba(0,0,0,0.8); }
    
    .thumbRow { display:flex; gap:10px; padding:12px; overflow-x:auto; background:rgba(6,15,26,0.25); border-top:1px solid var(--border); }
    .thumb { width:112px; aspect-ratio:16/10; border-radius:8px; overflow:hidden; border:1px solid rgba(255,255,255,0.1); flex-shrink:0; cursor:pointer; }
    .thumb.active { border-color: var(--brand-gold); }
    .thumb img { width:100%; height:100%; object-fit:cover; }

    .info { padding:18px; }
    .title { font-family:'Cormorant Garamond',serif; font-size:2rem; font-weight:300; margin-bottom:10px; }
    .gridSpecs { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-top:15px; }
    .specBox { padding:12px; border-radius:12px; border:1px solid rgba(206,168,108,0.18); background:rgba(6,15,26,0.22); }
    .specLbl { font-size:0.56rem; text-transform:uppercase; color:var(--brand-gold); letter-spacing:0.1em; }
    .specVal { font-size:1.05rem; margin-top:4px; }

    .section { margin-top:20px; padding-top:15px; border-top:1px solid rgba(255,255,255,0.08); }
    .secTitle { font-size:0.62rem; text-transform:uppercase; color:var(--brand-gold); letter-spacing:0.2em; margin-bottom:10px; }
    .text { font-size:0.95rem; line-height:1.7; color:var(--muted); white-space:pre-line; }

    .contactGrid { display:grid; grid-template-columns:repeat(2,1fr); gap:10px; padding: 15px; }
    .cbtn { display:flex; align-items:center; justify-content:center; height:46px; border-radius:10px; text-decoration:none; font-size:0.62rem; text-transform:uppercase; border:1px solid rgba(206,168,108,0.2); color:white; }
    .cbtn.primary { background:linear-gradient(135deg, var(--brand-gold), var(--brand-gold-hi)); color:var(--navy); font-weight:700; }

    /* LOADING & ERRORS */
    .loadingOverlay { position:fixed; inset:0; background:var(--navy); z-index:1000; display:flex; align-items:center; justify-content:center; flex-direction:column; }
    .isLoading main { visibility: hidden; }
    .isLoading .loadingOverlay { display: flex; }
    .loadingOverlay { display: none; }
    .spinner { width:40px; height:40px; border:3px solid rgba(206,168,108,0.2); border-top-color:var(--brand-gold); border-radius:50%; animation:spin 1s linear infinite; }
    @keyframes spin { to { transform:rotate(360deg); } }
  </style>
</head>

<body class="isLoading">
  <div class="loadingOverlay" id="loadingOverlay">
    <div class="spinner"></div>
    <div style="margin-top:15px; font-size:0.8rem; color:var(--brand-gold)" id="loadingText">Loading property details...</div>
  </div>

  <header id="mainHeader">
    <a href="index.html" class="logo">Hua Hin<span>.Properties</span></a>
    <div style="display:flex; gap:10px">
      <a href="index.html" id="backBtn" class="btn-top">â† Back</a>
      <a href="#contact" class="btn-cta">Contact</a>
    </div>
  </header>

  <main>
    <div id="errBox" style="display:none; color:red; padding:20px; text-align:center">Property not found.</div>
    
    <div class="panel">
      <div class="hero-media">
        <img id="heroImg" src="" alt="Property Photo">
        <button class="navBtn" style="left:10px" onclick="setHero(idx-1)">â®</button>
        <button class="navBtn" style="right:10px" onclick="setHero(idx+1)">â¯</button>
        <div class="priceOnly" id="priceOnly">à¸¿ â€”</div>
      </div>
      <div class="thumbRow" id="thumbRow"></div>
    </div>

    <div class="panel info">
      <div class="secTitle" id="propIdLine">Property ID</div>
      <div class="title" id="title">â€”</div>
      <div id="loc">ğŸ“ â€”</div>
      
      <div class="gridSpecs">
        <div class="specBox"><div class="specLbl">Bedrooms</div><div class="specVal" id="vBeds">â€”</div></div>
        <div class="specBox"><div class="specLbl">Bathrooms</div><div class="specVal" id="vBaths">â€”</div></div>
        <div class="specBox"><div class="specLbl">Living Area</div><div class="specVal" id="vLiving">â€”</div></div>
      </div>

      <div class="section">
        <div class="secTitle">Description</div>
        <div class="text" id="desc">â€”</div>
      </div>
    </div>

    <section class="panel contactGrid" id="contact">
      <a class="cbtn primary" href="https://line.me/R/ti/p/@qap7218t">LINE OA</a>
      <a class="cbtn" href="tel:+66805820777">Call</a>
    </section>
  </main>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec";
    const urlParams = new URLSearchParams(location.search);
    const HP_ID = urlParams.get("id");
    const isFocusMode = urlParams.get("mode") === "focus";

    let photos = [];
    let idx = 0;

    if (isFocusMode) {
      document.body.classList.add('mode-focus');
      // à¸›à¸£à¸±à¸šà¸¥à¸´à¸‡à¸à¹Œà¸›à¸¸à¹ˆà¸¡ Back à¹ƒà¸«à¹‰à¸£à¸±à¸à¸©à¸² mode=focus à¹„à¸§à¹‰
      const backBtn = document.getElementById('backBtn');
      if (backBtn) backBtn.href = `index.html?${urlParams.toString()}`;
    }

    async function start() {
      if (!HP_ID) return;
      try {
        const r = await fetch(`${SCRIPT_URL}?mode=getUnitDetail&id=${HP_ID}`);
        const json = await r.json();
        if (json.ok) render(json.data);
      } catch (e) { console.error(e); }
      document.body.classList.remove('isLoading');
    }

    function render(p) {
      document.getElementById('title').textContent = p.Project_Name || p.Type;
      document.getElementById('vBeds').textContent = p.Bedrooms;
      document.getElementById('vBaths').textContent = p.Bathrooms;
      document.getElementById('vLiving').textContent = p.Living_Area_sq_m + " mÂ²";
      document.getElementById('desc').textContent = p.Description || p.Key_Selling_Points;
      document.getElementById('priceOnly').textContent = "à¸¿" + (parseFloat(p.Sale_Price.replace(/[^0-9.]/g,'')) || 0).toLocaleString();
      document.getElementById('propIdLine').textContent = "Property ID: " + p.HP_ID;
      document.getElementById('loc').textContent = "ğŸ“ " + p.Zone + ", " + p.District;

      photos = p.__album || [];
      if (photos.length > 0) {
        renderThumbs();
        setHero(0);
      }
    }

    function renderThumbs() {
      const row = document.getElementById('thumbRow');
      row.innerHTML = photos.map((src, i) => `
        <div class="thumb ${i===0?'active':''}" onclick="setHero(${i})">
          <img src="${src}">
        </div>
      `).join('');
    }

    function setHero(i) {
      idx = (i + photos.length) % photos.length;
      document.getElementById('heroImg').src = photos[idx];
      const thumbs = document.querySelectorAll('.thumb');
      thumbs.forEach((t, k) => t.classList.toggle('active', k === idx));
    }

    start();
  </script>
</body>
</html>
